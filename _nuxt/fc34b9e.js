(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{422:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(4),o=n(30),c=n(31),l=(n(25),n(3)),m=n(1),d=n.n(m),_=n(6),f=n(5),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,t),this.json=e}var e,n,m,h,j,v,x;return Object(c.a)(t,[{key:"save",value:(x=Object(r.a)(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,r=Object(f.e)(this.json,"blog"),!this.json.id){t.next=8;break}return t.next=5,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(e,"/blogs/").concat(this.json.id)),{data:r,headers:Object(_.c)(!0)});case 5:n=t.sent,t.next=11;break;case 8:return t.next=10,Object(_.d)("post",Object(_.e)(_.a,"projects/".concat(e,"/blogs")),{data:r,headers:Object(_.c)(!0)});case 10:n=t.sent;case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,this)}))),function(t){return x.apply(this,arguments)})},{key:"hideComment",value:(v=Object(r.a)(regeneratorRuntime.mark((function t(e,n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(e,"/blogs/").concat(n,"/comments/").concat(r,"/hide_comment")),{headers:Object(_.c)(!0)});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t,e,n){return v.apply(this,arguments)})},{key:"unhideComment",value:(j=Object(r.a)(regeneratorRuntime.mark((function t(e,n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(e,"/blogs/").concat(n,"/comments/").concat(r,"/unhide_comment")),{headers:Object(_.c)(!0)});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t,e,n){return j.apply(this,arguments)})},{key:"activate",value:(h=Object(r.a)(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(e,"/blogs/").concat(n,"/activate")),{headers:Object(_.c)(!0)});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t,e){return h.apply(this,arguments)})},{key:"inactivate",value:(m=Object(r.a)(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(e,"/blogs/").concat(n,"/inactivate")),{headers:Object(_.c)(!0)});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t,e){return m.apply(this,arguments)})},{key:"asTableJson",value:function(){return{id:this.json.id,running_number:this.json.running_number,no:this.json.no,owner:{full_name_en:this.json.user?this.json.user.full_name_en:"-",full_name_th:this.json.user?this.json.user.full_name_th:"-"},created_at:Object(f.h)(this.json.created_at),title:this.json.title,tag_name_translations:this.json.tag_name_translations,status:this.json.status}}}],[{key:"index",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(n,r,o,c,m,f){var h,j,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h="",f&&(h=d()(f).unix()),e.next=4,Object(_.d)("get",Object(_.e)(_.a,"projects/".concat(n,"/blogs")),{headers:Object(_.c)(!0),params:{status:r,page:o,per_page:c,search:m,query_date:h}});case 4:if(200!==(j=e.sent).status){e.next=8;break}return v=Object(l.map)(j.data.blogs,(function(e,n){return e.no=n+1,new t(e)})),e.abrupt("return",{blogs:v,total_count:j.data.total_count});case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)}))),function(t,e,r,o,c,l){return n.apply(this,arguments)})},{key:"show",value:(e=Object(r.a)(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)("get",Object(_.e)(_.a,"projects/".concat(n,"/blogs/").concat(r)),{headers:Object(_.c)(!0)});case 2:if(200!==(o=e.sent).status){e.next=5;break}return e.abrupt("return",new t(o.data.blog));case 5:return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),function(t,n){return e.apply(this,arguments)})}]),t}()},505:function(t,e,n){var content=n(614);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(23).default)("17b07624",content,!0,{sourceMap:!1})},613:function(t,e,n){"use strict";n(505)},614:function(t,e,n){var r=n(22)(!1);r.push([t.i,".header-content{font-weight:700}.custom-font-size{font-size:12px}.custom-text-position{text-align:right}",""]),t.exports=r},756:function(t,e,n){"use strict";n.r(e);var r=n(4),o=(n(25),n(48),n(11),n(1)),c=n.n(o),l=n(5),m=n(422),d={data:function(){return{isLoading:!0,isLoadingComment:!1,blog:null}},computed:{language:function(){return this.$store.state.language.value},categoriesName:function(){var t=this,e=this.blog.json.tags.map((function(e){return e.name_translations[t.language]}));return e.length>1?e.join(", "):e[0]}},mounted:function(){this.fetchBlog()},methods:{fullFormatDatetime:l.i,timeFromNow:function(time){return c()(time).fromNow()},handleSubmit:function(t){var e=this;return new Promise((function(n){e.$Modal.confirm({title:e.$t("messages.confirm"),content:t.is_hide?e.$t("messages.confirm_unhide_comment"):e.$t("messages.confirm_hide_comment"),okText:e.$t("button.yes"),cancelText:e.$t("button.no"),onOk:function(){e.actionComments(t)}})}))},actionComments:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=new m.a,!t.is_hide){n.next=7;break}return n.next=4,o.unhideComment(e.$route.params.projectId,t.blog_id,t.id);case 4:r=n.sent,n.next=10;break;case 7:return n.next=9,o.hideComment(e.$route.params.projectId,t.blog_id,t.id);case 9:r=n.sent;case 10:r&&r.data.success?(e.$Message.success({content:t.is_hide?e.$t("messages.successfully_unhide_comment"):e.$t("messages.successfully_hide_comment"),duration:3}),e.isLoadingComment=!0,e.fetchBlog()):r.data&&r.data.error?e.$Message.error({content:r.data.error,duration:8}):e.$Message.error({content:e.$t("messages.fail"),duration:8});case 11:case"end":return n.stop()}}),n)})))()},fetchBlog:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.show(t.$route.params.projectId,t.$route.params.blogId);case 2:t.blog=e.sent,t.isLoadingComment=!1,t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()}}},_=(n(613),n(9)),component=Object(_.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isLoading?n("GLoading"):n("div",[n("GBreadCrumb",{attrs:{names:[t.blog.json.running_number]}}),t._v(" "),n("Card",{attrs:{bordered:!1,"dis-hover":"",padding:20}},[n("div",{attrs:{slot:"title"},slot:"title"},[n("p",[t._v(t._s(t.$t("pages.blog")))])]),t._v(" "),n("Row",{attrs:{type:"flex",gutter:24}},[n("Col",{staticClass:"mb-10",attrs:{xs:24,md:12}},[n("Card",{attrs:{"dis-hover":""}},[n("Row",{attrs:{type:"flex",justify:"space-between"}},[n("Col",[n("span",{staticClass:"header-content"},[t._v(t._s(t.$t("info.blog.label.title"))+":")]),t._v("\n              "+t._s(t.blog.json.title)+"\n            ")])],1),t._v(" "),n("Row",[n("Col",[n("span",{staticClass:"header-content"},[t._v(t._s(t.$t("info.category.label.name"))+":")]),t._v("\n              "+t._s(t.categoriesName)+"\n            ")])],1),t._v(" "),n("Row",[n("Col",[n("span",{staticClass:"header-content"},[t._v("\n                "+t._s(t.$t("info.category.label.description"))+":\n              ")]),t._v("\n              "+t._s(t.blog.json.description)+"\n            ")])],1),t._v(" "),n("Row",{staticClass:"mt-10"},[n("Col",{staticClass:"header-content"},[t._v("\n              "+t._s(t.$t("info.blog.label.cover_image"))+":\n            ")]),t._v(" "),t.blog.json.cover_image&&t.blog.json.cover_image.url?n("Col",[n("GGallery",{attrs:{"single-images":t.blog.json.cover_image}})],1):t._e()],1),t._v(" "),t.blog.json.images&&t.blog.json.images.length>0?n("Row",[n("Col",[n("GGallery",{attrs:{"separate-image":!0,"count-image-list":t.blog.json.images?t.blog.json.images.length:0,images:t.blog.json.images,"blog-images":"",title:t.blog.json.images&&t.blog.json.images.length>0?t.$t("info.blog.label.images")+":":""}})],1)],1):t._e(),t._v(" "),n("br"),t._v(" "),n("Row",{attrs:{type:"flex",justify:"end",gutter:12}},[n("Col",{attrs:{xs:24}},[n("div",{staticClass:"float-right pl-20"},[n("span",{staticClass:"header-content custom-font-size"},[t._v("\n                  "+t._s(t.$t("info.incident.label.created_at"))+":\n                ")]),t._v(" "),n("span",{staticClass:"custom-font-size"},[t._v("\n                  "+t._s(t.fullFormatDatetime(t.blog.json.created_at))+"\n                ")])]),t._v(" "),n("div",{staticClass:"float-right"},[n("span",{staticClass:"header-content custom-font-size"},[t._v("\n                  "+t._s(t.$t("info.incident.label.created_by"))+":\n                ")]),t._v(" "),n("span",{staticClass:"custom-font-size"},[t._v("\n                  "+t._s(t.blog.json.user["full_name_"+t.language])+"\n                ")])])])],1)],1)],1),t._v(" "),n("Col",{attrs:{xs:24,md:12}},[n("Card",{attrs:{"dis-hover":"",padding:20}},[n("div",{staticClass:"my-10",attrs:{slot:"title"},slot:"title"},[n("h3",[t._v("\n              "+t._s(t.$t("pages.comments"))+"\n            ")])]),t._v(" "),t.blog.json.comments.length?n("div",t._l(t.blog.json.comments,(function(e,r){return n("div",{key:e.id},[n("Row",{staticClass:"mb-15",style:r===t.blog.json.comments.length-1?"":"border-bottom: 1px solid rgb(226 225 225)",attrs:{type:"flex",gutter:10}},[e.user.profile_image&&e.user.profile_image.url?n("Col",{staticClass:"text-center",attrs:{xs:4,sm:6,md:6,lg:4}},[n("img",{staticStyle:{"border-radius":"50%"},attrs:{src:e.user.profile_image.url,width:"40",height:"40",alt:""}})]):t._e(),t._v(" "),t.isLoadingComment?t._e():n("Col",{style:{color:e.is_hide?"#b9b9b9":"5d5d5d"},attrs:{xs:18,sm:18,md:18,lg:20}},[n("Row",{attrs:{type:"flex",justify:"space-between"}},[n("Col",{attrs:{span:"14"}},[n("h4",[t._v("\n                        "+t._s(e.user["full_name_"+t.language])+"\n                      ")])]),t._v(" "),n("Col",[n("p",[t._v("\n                        "+t._s(t.timeFromNow(e.created_at))+"\n                      ")])]),t._v(" "),n("Col",[n("Button",{attrs:{size:"small",type:e.is_hide?"info":"error",ghost:""},on:{click:function(n){return t.handleSubmit(e)}}},[t._v(t._s(e.is_hide?t.$t("button.un_hide"):t.$t("button.hide")))])],1)],1),t._v(" "),n("p",[t._v("\n                    "+t._s(e.content)+"\n                  ")])],1)],1)],1)})),0):n("Row",{attrs:{type:"flex",justify:"center"}},[n("Col",[t._v(t._s(t.$t("messages.no_comment")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);