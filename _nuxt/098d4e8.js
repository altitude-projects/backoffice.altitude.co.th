(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{540:function(e,t,n){var content=n(688);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("51d1a1a8",content,!0,{sourceMap:!1})},685:function(e,t,n){"use strict";n(686)("small",(function(e){return function(){return e(this,"small","","")}}))},686:function(e,t,n){var o=n(8),r=n(19),l=n(49),c=/"/g,d=function(e,t,n,o){var r=String(l(e)),d="<"+t;return""!==n&&(d+=" "+n+'="'+String(o).replace(c,"&quot;")+'"'),d+">"+r+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(d),o(o.P+o.F*r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},687:function(e,t,n){"use strict";n(540)},688:function(e,t,n){var o=n(22)(!1);o.push([e.i,".border-none .ivu-upload-drag{border:none!important}.upload-image-circle .ivu-upload-drag,.upload-image .ivu-upload-drag{height:100px!important}.background-black .ivu-upload-drag{background-color:unset;border-radius:4px}.background-black i{color:#8b8b8b}.upload-files .ivu-upload-drag,.upload-image-circle .ivu-upload-drag{border:0}.upload-image{display:inline-block;text-align:center;overflow:hidden;position:relative;margin-right:4px}.upload-image .image{-o-object-fit:cover;object-fit:cover;width:100%;height:100px}.upload-image-circle{border-radius:100%}.upload-image-circle .image,.upload-image-circle .upload-image-cover{border-radius:100%;height:100px}.upload-image-size{width:100px}.upload-image-cover{line-height:100px;position:absolute;top:0;bottom:0;left:0;right:0}.upload-files{display:inline-block;text-align:left}.upload-image i{display:inline-block;font-size:35px;cursor:pointer;margin:0 2px}.upload-list{display:inline-block;text-align:center;border:1px solid transparent;border-radius:6px;overflow:hidden;background:#fff;position:relative;box-shadow:0 1px 1px rgba(0,0,0,.2);margin-right:4px}.upload-list-large,.upload-list-small{width:100px;height:100px;line-height:100px}.upload-list img{height:100px;-o-object-fit:cover;object-fit:cover}.upload-list-cover{display:none;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.6)}.upload-list:hover .upload-list-cover{display:block}.upload-list-cover i{color:#fff;font-size:20px;cursor:pointer;margin:0 2px}.upload-large,.upload-small{display:inline-block;width:100px}.div-upload-large{width:100px;height:100px;line-height:100px}.div-upload-small{width:100px;height:97px;line-height:98px}.ivu-modal-close .ivu-icon-ios-close{top:10px;right:10px}.loading{line-height:unset;margin-top:0;-webkit-animation:ani-demo-spin .5s linear infinite;animation:ani-demo-spin .5s linear infinite}@-webkit-keyframes ani-demo-spin{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(1turn)}}@keyframes ani-demo-spin{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(1turn)}}",""]),e.exports=o},823:function(e,t,n){"use strict";n.r(t);var o=n(4),r=n(7),l=(n(25),n(16),n(11),n(685),n(83),n(3)),c={filters:{},props:{multiple:{type:Boolean,default:function(){return!1}},extraButton:{type:String,default:function(){return""}},isIncident:{type:Boolean,default:function(){return!1}},showButton:{type:Boolean,default:function(){return!1}},customProperties:{type:Object,default:function(){return{}}},fieldKey:{type:String,default:function(){return""}},checkOnSuccess:{type:Boolean,default:function(){return!1}},showOnly:{type:Boolean,default:function(){return!1}},small:{type:Boolean,default:function(){return!1}},value:{validator:function(e){return Object(l.isObject)(e)||Object(l.isArray)(e)||e instanceof File},default:function(e){return Object(l.isArray)(e)?[]:{}}},selectType:{type:String,default:function(){return"select"}},showUploadList:{type:Boolean,default:function(){return!1}},size:{type:String,default:function(){return"large"}},uploadImageCircle:{type:Boolean,default:function(){return!1}}},data:function(){return{previewItem:"",uploadList:[],visible:!1,loading:!1,renderAlertMessages:!1,concatFiles:[],defaultImage:"/assets/no_available.png"}},computed:{onShowUploadList:function(){return this.showUploadList&&!this.multiple},filterUploadList:function(){return this.showUploadList?[]:Object(l.filter)(this.uploadList,(function(e){return"delete"!==e.action}))}},watch:{value:function(e,t){if(this.multiple){var n=Object(l.compact)(e);Object(l.forEach)(n,(function(e,t){e.index=t})),this.uploadList=n}},renderAlertMessages:function(e){var t=this;e&&this.$Message.error({top:50,duration:3,content:this.$t("messages.limit_upload")}),setTimeout((function(){t.renderAlertMessages=!1}),1800)}},mounted:function(){this.checkValue()},methods:{checkValue:function(){if(this.multiple&&Object(l.isEmpty)(this.uploadList)){var e=Object(l.compact)(this.value);Object(l.forEach)(e,(function(e,t){e.index=t})),this.uploadList=e}},handleView:function(e){this.previewItem=e,this.visible=!0},clearFiles:function(e){var t=this;!this.multiple&&this.value.url&&this.$Modal.confirm({title:this.$t("messages.confirm_save"),okText:this.$t("button.yes"),cancelText:this.$t("button.no"),onOk:function(){var e=Object(l.cloneDeep)(t.value);e.action="delete",t.$emit("updateParentValue",Object(r.a)({},t.fieldKey,e),!0)}});var n=Object(l.cloneDeep)(this.uploadList);if(n[e]&&n[e].url){n[e]=Object(l.omit)(n[e],["url","content_type"]),n[e].action="delete";var o=n[e];this.$Modal.confirm({title:this.$t("messages.confirm_save"),okText:this.$t("button.yes"),cancelText:this.$t("button.no"),onOk:function(){n.splice(e,1),n=Object(l.concat)(n,o),t.$emit("updateParentValue",Object(r.a)({},t.fieldKey,n),!0)}})}else(!this.value.url||n[e]&&!n[e].url)&&(n.splice(e,1),this.$emit("updateParentValue",Object(r.a)({},this.fieldKey,n),!0))},handleFormatError:function(e){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+e.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(e){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+e.name+" is too large, no more than 2M."})},validate:function(e){if(Object(l.isEmpty)(this.customProperties.format))return!0;var t=this.subFileType(e.type),n=Object(l.includes)(this.customProperties.format,t);return n||this.handleFormatError(e),n},checkMaxSizeImage:function(e,t,image){var n=!1,o=image.width,r=image.height;return o>r&&o>e&&(r*=e/o,o=e,n=!0),r>t&&(o*=t/r,r=t,n=!0),{isResized:n,width:o,height:r}},resizeImage:function(img,e){var t=this;return new Promise((function(n,o){img.onload=function(){var image,canvas=document.createElement("canvas");if((image=t.small?t.checkMaxSizeImage(320,240,img):t.checkMaxSizeImage(1024,1024,img)).isResized){canvas.width=image.width,canvas.height=image.height;var o=canvas.getContext("2d");o.drawImage(img,0,0,image.width,image.height);var r=o.canvas.toDataURL(img,e.type);e.src=r,fetch(r).then((function(e){return e.blob()})).then((function(t){var o=new File([t],e.name,{type:e.type});o.src=e.src,n(o)}))}else n(e)}}))},handleUpload:function(e){var t,n=this,image=new Image;if(this.validate(e)){this.loading=!0;var c=new FileReader;c.readAsDataURL(e),c.onload=function(){var d=Object(o.a)(regeneratorRuntime.mark((function o(d){var f;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(image.src=c.result,e.src=c.result,"image"!==n.fileType(e.type)){o.next=7;break}return o.next=5,n.resizeImage(image,e);case 5:t=o.sent,n.multiple?n.checkOnSuccess?n.concatFiles.push(t):((f=[]).push(t),f=Object(l.concat)(n.value,e),n.isIncident&&f.length>10?(n.renderAlertMessages=!0,f=Object(l.filter)(f,(function(e,t){return t<=9})),n.$emit("updateParentValue",Object(r.a)({},n.fieldKey,f))):n.$emit("updateParentValue",Object(r.a)({},n.fieldKey,f))):n.checkOnSuccess?n.$emit("updateParentValue",Object(r.a)({},n.fieldKey,e)):n.$emit("updateParentValue",Object(r.a)({},n.fieldKey,t));case 7:n.loading=!1;case 8:case"end":return o.stop()}}),o)})));return function(e){return d.apply(this,arguments)}}()}return this.checkOnSuccess},handleSuccess:function(e,t,n){var o=!0;if(Object(l.map)(n,(function(e){"uploading"===e.status&&(o=!1)})),o){var c=this.concatFiles.concat(this.value);this.$emit("updateParentValue",Object(r.a)({},this.fieldKey,c))}},pdfPreview:function(data){if(data.url)window.open(data.url);else{var iframe="<iframe width='100%' height='100%' src='"+data.src+"'></iframe>",e=window.open();e.document.open(),e.document.write(iframe),e.document.close()}},fileType:function(e){if(e){var t=e.split("/");return t[0]}return""},subFileType:function(e){return e?e.split("/")[1]:""},copyImageUrl:function(e){this.$copyText(e),this.$Message.success({content:"Copied Image Url Success",duration:3})}}},d=(n(687),n(9)),component=Object(d.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.showButton||"drag"===e.selectType?n("div",[n("Upload",e._b({ref:"upload",class:[e.showButton?"upload-files":null],attrs:{multiple:e.multiple,"default-file-list":e.uploadList,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError,"show-upload-list":e.onShowUploadList,"on-success":e.handleSuccess,"before-upload":e.handleUpload,type:e.selectType,action:""}},"Upload",e.customProperties,!1),["drag"===e.selectType?n("div",{staticStyle:{height:"157px","padding-top":"40px"}},[n("Icon",{attrs:{type:"md-cloud-upload",size:"32"}}),e._v(" "),n("p",[e._v(e._s(e.$t("placeholder.drag_to_upload_helper")))])],1):e._e()]),e._v(" "),e._l(e.filterUploadList,(function(t,o){return n("div",{key:o,staticStyle:{"overflow-wrap":"break-word"}},[n("Icon",{staticClass:"mr-5",attrs:{type:"ios-attach"}}),e._v(" "),"image"===e.fileType(t.type?t.type:t.content_type)?n("a",{on:{click:function(n){return e.handleView(t)}}},[e._v("\n        "+e._s(t.name)+"\n      ")]):"pdf"===e.subFileType(t.type?t.type:t.content_type)?n("a",{on:{click:function(n){return e.pdfPreview(t)}}},[e._v("\n        "+e._s(t.name)+"\n      ")]):n("a",{attrs:{href:t.src,download:t.name}},[e._v("\n        "+e._s(t.name)+"\n      ")]),e._v(" "),n("span",{staticStyle:{float:"right"}},[n("Icon",{staticClass:"pointer",attrs:{type:"md-close"},nativeOn:{click:function(n){return e.clearFiles(t.index)}}})],1)],1)}))],2):e.multiple?n("div",[n("Row",{attrs:{type:"flex",gutter:20}},[e._l(e.filterUploadList,(function(t,o){return n("Col",{key:o,staticClass:"text-center"},[n("div",{class:"upload-list upload-list-"+e.size},["image"===e.fileType(t.type?t.type:t.content_type)?n("div",[n("div",[n("img",{style:{width:"100%"},attrs:{src:t.src||t.url}}),e._v(" "),n("div",{staticClass:"upload-list-cover"},[n("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(n){return e.handleView(t)}}}),e._v(" "),e.multiple?n("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(n){return e.clearFiles(t.index)}}}):e._e()],1)])]):n("div",{staticStyle:{display:"inline-block"}},[n("video",{attrs:{width:"320",height:"240",controls:""}},[n("source",{attrs:{src:t.url,type:"video/mp4"}})]),e._v(" "),n("Icon",{attrs:{type:"md-document",size:"30"}}),e._v(" "),n("div",{staticClass:"upload-list-cover"},[n("a",{attrs:{href:t.src,download:t.name}},[n("Icon",{attrs:{type:"ios-eye-outline"}})],1),e._v(" "),n("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(n){return e.clearFiles(t.index)}}})],1)],1)]),e._v(" "),e.extraButton?n("div",{staticClass:"text-center"},[t.url?n("Button",{attrs:{size:"small"},on:{click:function(n){return e.copyImageUrl(t.url)}}},[e._v("\n            "+e._s(e.extraButton)+"\n          ")]):e._e()],1):e._e()])})),e._v(" "),n("Col",{staticClass:"text-center"},[e.showOnly?e._e():n("Upload",e._b({ref:"upload",class:"upload-"+e.size,attrs:{multiple:e.multiple,"default-file-list":e.uploadList,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError,"show-upload-list":e.onShowUploadList,"on-success":e.handleSuccess,"before-upload":e.handleUpload,type:"drag",action:""}},"Upload",e.customProperties,!1),[n("div",{class:"div-upload-"+e.size},[e.loading?n("Icon",{staticClass:"loading",attrs:{type:"ios-loading",size:"32"}}):n("Icon",{attrs:{type:"md-cloud-upload",size:"32"}})],1)])],1)],2)],1):n("div",[n("Row",{attrs:{type:"flex",gutter:20}},[n("Col",{staticClass:"text-center"},[n("Upload",e._b({ref:"upload",staticClass:"upload-image upload-image-size",class:(e.uploadImageCircle?"upload-image-circle":"")+" "+(e.value.src||e.value.url?"background-black border-none":""),attrs:{"before-upload":e.handleUpload,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError,type:"drag",action:""}},"Upload",e.customProperties,!1),[!e.value.src&&!e.value.url||e.value.action?n("div",{class:"div-upload-"+e.size},[n("Icon",{attrs:{type:"md-cloud-upload",size:"32"}})],1):n("div",{class:"upload-list upload-list-"+e.size},[n("img",{style:{width:"100%"},attrs:{src:e.value.src||e.value.url}}),e._v(" "),n("span",{staticClass:"upload-list-cover"},[n("Icon",{attrs:{type:"md-cloud-upload",size:"32"}})],1)])]),e._v(" "),!e.value.src&&!e.value.url||e.value.action?e._e():n("div",{staticClass:"text-center"},[n("Button",{attrs:{size:"small",type:"error",ghost:""},nativeOn:{click:function(t){return e.clearFiles()}}},[e._v("\n            "+e._s(e.$t("button.delete"))+"\n          ")])],1)],1)],1)],1),e._v(" "),n("Modal",{attrs:{"footer-hide":"","mask-closable":!1},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?n("img",{attrs:{src:e.previewItem.src||e.previewItem.url,width:"100%"}}):e._e()])],1)}),[],!1,null,null,null);t.default=component.exports}}]);