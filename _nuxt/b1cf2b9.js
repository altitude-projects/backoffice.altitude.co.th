(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{422:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(4),c=n(30),o=n(31),h=(n(25),n(3)),l=n(1),d=n.n(l),m=n(6),f=n(5),j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.json=t}var t,n,l,j,v,O,_;return Object(o.a)(e,[{key:"save",value:(_=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,r=Object(f.e)(this.json,"blog"),!this.json.id){e.next=8;break}return e.next=5,Object(m.d)("patch",Object(m.e)(m.a,"projects/".concat(t,"/blogs/").concat(this.json.id)),{data:r,headers:Object(m.c)(!0)});case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,Object(m.d)("post",Object(m.e)(m.a,"projects/".concat(t,"/blogs")),{data:r,headers:Object(m.c)(!0)});case 10:n=e.sent;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"hideComment",value:(O=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)("patch",Object(m.e)(m.a,"projects/".concat(t,"/blogs/").concat(n,"/comments/").concat(r,"/hide_comment")),{headers:Object(m.c)(!0)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return O.apply(this,arguments)})},{key:"unhideComment",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)("patch",Object(m.e)(m.a,"projects/".concat(t,"/blogs/").concat(n,"/comments/").concat(r,"/unhide_comment")),{headers:Object(m.c)(!0)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"activate",value:(j=Object(r.a)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)("patch",Object(m.e)(m.a,"projects/".concat(t,"/blogs/").concat(n,"/activate")),{headers:Object(m.c)(!0)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return j.apply(this,arguments)})},{key:"inactivate",value:(l=Object(r.a)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)("patch",Object(m.e)(m.a,"projects/".concat(t,"/blogs/").concat(n,"/inactivate")),{headers:Object(m.c)(!0)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})},{key:"asTableJson",value:function(){return{id:this.json.id,running_number:this.json.running_number,no:this.json.no,owner:{full_name_en:this.json.user?this.json.user.full_name_en:"-",full_name_th:this.json.user?this.json.user.full_name_th:"-"},created_at:Object(f.h)(this.json.created_at),title:this.json.title,tag_name_translations:this.json.tag_name_translations,status:this.json.status}}}],[{key:"index",value:(n=Object(r.a)(regeneratorRuntime.mark((function t(n,r,c,o,l,f){var j,v,O;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j="",f&&(j=d()(f).unix()),t.next=4,Object(m.d)("get",Object(m.e)(m.a,"projects/".concat(n,"/blogs")),{headers:Object(m.c)(!0),params:{status:r,page:c,per_page:o,search:l,query_date:j}});case 4:if(200!==(v=t.sent).status){t.next=8;break}return O=Object(h.map)(v.data.blogs,(function(t,n){return t.no=n+1,new e(t)})),t.abrupt("return",{blogs:O,total_count:v.data.total_count});case 8:return t.abrupt("return",[]);case 9:case"end":return t.stop()}}),t)}))),function(e,t,r,c,o,h){return n.apply(this,arguments)})},{key:"show",value:(t=Object(r.a)(regeneratorRuntime.mark((function t(n,r){var c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.d)("get",Object(m.e)(m.a,"projects/".concat(n,"/blogs/").concat(r)),{headers:Object(m.c)(!0)});case 2:if(200!==(c=t.sent).status){t.next=5;break}return t.abrupt("return",new e(c.data.blog));case 5:return t.abrupt("return",c);case 6:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)})}]),e}()},727:function(e,t,n){"use strict";n.r(t);var r=n(4),c=(n(25),n(54),n(108),n(1)),o=n.n(c),h=n(3),l=n(422),d={data:function(){return{blogs:[],loading:!1,isLoading:!0,currentTab:"",currentPage:1,pageSize:10,search:"",datetime:"",tabs:["active","inactive"],totalPages:0}},mounted:function(){this.datetime||(this.datetime=o()().format("yyyy-MM")),this.setActiveTab()},methods:{setActiveTab:function(e){e?this.currentTab=e:this.$route.hash?this.currentTab=this.$route.hash.replace("#",""):this.currentTab="active",this.fetchBlogs()},fetchBlogs:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e?t.isLoading=!0:t.loading=!0,n.next=3,l.a.index(t.$route.params.projectId,t.currentTab,t.currentPage,t.pageSize,t.search,t.datetime);case 3:r=n.sent,t.blogs=Object(h.map)(r.blogs,(function(e){return e.asTableJson()})),t.totalPages=r.total_count,t.isLoading=!1,t.loading=!1;case 8:case"end":return n.stop()}}),n)})))()},handleTabChange:function(e){this.currentPage=1,e&&(this.$router.push({hash:e}),this.setActiveTab(e))},searchItem:function(e){this.search=e,this.currentPage=1,this.fetchBlogs()},fetchItems:function(e,t){this.currentPage=e,this.pageSize=t,this.fetchBlogs(!0)},fetchDateTime:function(e){this.datetime=e,this.fetchBlogs()}}},m=n(9),component=Object(m.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isLoading?n("GLoading"):n("Card",{attrs:{"dis-hover":"",bordered:!1}},[n("div",{attrs:{slot:"title"},slot:"title"},[n("h3",[e._v("\n        "+e._s(e.$t("pages.blogs"))+"\n      ")])]),e._v(" "),n("GDateTime",{attrs:{datetime:e.datetime},on:{fetchDateTime:e.fetchDateTime}}),e._v(" "),n("Tabs",{staticClass:"mt-20",attrs:{type:"card",animated:!1},on:{"on-click":e.handleTabChange},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},e._l(e.tabs,(function(t){return n("TabPane",{key:t,attrs:{label:e.$t("status."+t),name:t}},[e.currentTab===t?n("GIndexPage",{attrs:{"width-column":"100%",items:e.blogs,"show-sizer":"","search-by-api":"","current-page":e.currentPage,"page-size":e.pageSize,"total-pages":e.totalPages,loading:e.loading,component:"GBlogTable"},on:{handleToSearchItem:e.searchItem,reloadData:e.fetchBlogs,pageAndItemPerPage:e.fetchItems}}):e._e()],1)})),1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);