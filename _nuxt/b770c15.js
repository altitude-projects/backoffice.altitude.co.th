(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{410:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(4),o=r(30),c=r(31),l=(r(25),r(3)),_=r(6),m=r(5),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,e),this.json=t}var t,r,d,f,j,y;return Object(c.a)(e,[{key:"save",value:(y=Object(n.a)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,n=Object(m.e)(this.json,"unitType"),!this.json.id){e.next=8;break}return e.next=5,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(t,"/asset_types/").concat(this.json.id)),{headers:Object(_.c)(!0),data:n});case 5:r=e.sent,e.next=11;break;case 8:return e.next=10,Object(_.d)("post",Object(_.e)(_.a,"projects/".concat(t,"/asset_types")),{headers:Object(_.c)(!0),data:n});case 10:r=e.sent;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"activate",value:(j=Object(n.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(t,"/asset_types/").concat(this.json.id,"/activate")),{headers:Object(_.c)(!0)});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"inactivate",value:(f=Object(n.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(t,"/asset_types/").concat(this.json.id,"/inactivate")),{headers:Object(_.c)(!0)});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})}],[{key:"unitTypeForSelect",value:(d=Object(n.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)("get",Object(_.e)(_.a,"projects/".concat(t,"/asset_types/asset_types_for_select")),{headers:Object(_.c)(!0)});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",r.data.asset_types);case 5:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})},{key:"index",value:(r=Object(n.a)(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.d)("get",Object(_.e)(_.a,"projects/".concat(r,"/asset_types")),{headers:Object(_.c)(!0)});case 2:if(200!==(n=t.sent).status){t.next=5;break}return t.abrupt("return",Object(l.map)(n.data.asset_types,(function(t,r){return t.no=r+1,new e(t,r)})));case 5:return t.abrupt("return",[]);case 6:case"end":return t.stop()}}),t)}))),function(e){return r.apply(this,arguments)})},{key:"show",value:(t=Object(n.a)(regeneratorRuntime.mark((function t(r,n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.d)("get",Object(_.e)(_.a,"projects/".concat(r,"/asset_types/").concat(n)),{headers:Object(_.c)(!0)});case 2:if(200!==(o=t.sent).status){t.next=5;break}return t.abrupt("return",new e(o.data.asset_type));case 5:case"end":return t.stop()}}),t)}))),function(e,r){return t.apply(this,arguments)})}]),e}()},419:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));r(21),r(15),r(18),r(32),r(33);var n=r(4),o=r(7),c=r(30),l=r(31),_=(r(16),r(25),r(3)),m=r(1),d=r.n(m),f=r(6),j=r(5);function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.json=h(h({},t),{},{extra_detail_json:t.extra_detail_json||{price_per_unit:"",payment_calculation_by:"",asset_types:{}}}),this.json.extra_detail_json.price_per_unit=Object(j.m)(this.json.extra_detail_json.price_per_unit)}var t,r,o,m;return Object(l.a)(e,[{key:"generateBilling",value:(m=Object(n.a)(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(t,"/billing_cycles/").concat(r,"/generate_billing")),{data:{billing_cycle_id:r},headers:Object(f.c)(!0)});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)})},{key:"save",value:(o=Object(n.a)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,(n=Object(_.cloneDeep)(this.json)).from_date=d()(this.json.from_date).format("YYYY-MM-DD"),n.to_date=d()(this.json.to_date).format("YYYY-MM-DD"),!this.json.id){e.next=10;break}return e.next=7,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(t,"/billing_cycles/").concat(this.json.id)),{data:{billing_cycle:n},headers:Object(f.c)(!0)});case 7:r=e.sent,e.next=13;break;case 10:return e.next=12,Object(f.d)("post",Object(f.e)(f.a,"projects/".concat(t,"/billing_cycles")),{data:{billing_cycle:n},headers:Object(f.c)(!0)});case 12:r=e.sent;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"asTableJson",value:function(){return{id:this.json.id,name:this.json.name,project_id:this.json.project_id,to_date:this.json.to_date,from_date:this.json.from_date,month:this.json.month,extra_detail_json:this.json.extra_detail_json,price_per_unit:Object(j.c)(this.json.extra_detail_json.price_per_unit)||0}}}],[{key:"index",value:(r=Object(n.a)(regeneratorRuntime.mark((function t(r,n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(r,"/billing_cycles")),{params:{type:n},headers:Object(f.c)(!0)});case 2:if(200!==(o=t.sent).status){t.next=5;break}return t.abrupt("return",Object(_.map)(o.data.billing_cycles,(function(t){return new e(t)})));case 5:return t.abrupt("return",[]);case 6:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})},{key:"billingCycleTypes",value:(t=Object(n.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(t,"/billing_cycles/billing_cycle_types")),{headers:Object(f.c)(!0)});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",r.data.data);case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}()},779:function(e,t,r){"use strict";r.r(t);var n=r(4),o=(r(11),r(25),r(3)),c=r(419),l=r(410),_={props:{isNew:{type:Boolean,default:!1}},data:function(){return{formData:new c.a,unitTypes:[],isHighRise:!1,rules:{asset_number:[{required:!0,message:this.$t("form.unit.label.asset_number")+" "+this.$t("error.cannot_be_blank"),trigger:"blur,change"}],address_number:[{required:!0,message:this.$t("form.unit.label.address_number")+" "+this.$t("error.cannot_be_blank"),trigger:"blur,change"}],asset_type_id:[{required:!0,message:this.$t("form.unit.label.asset_type")+" "+this.$t("error.cannot_be_blank"),trigger:"blur,change"}]}}},watch:{"formData.json.extra_detail_json.payment_calculation_by":function(e){"asset_type"===e&&(this.formData.json.extra_detail_json.asset_types=Object(o.map)(this.unitTypes,(function(e){return{asset_id:e.id,price_per_unit:e.price_per_unit}})))}},mounted:function(){this.fetchUnitTypes()},methods:{fetchUnitTypes:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,l.a.index(e.$route.params.projectId);case 3:r=t.sent,e.unitTypes=Object(o.map)(r,(function(u){return u.json})),e.isLoading=!1;case 6:case"end":return t.stop()}}),t)})))()},handleSubmit:function(){var e=this;return new Promise((function(t){e.$Modal.confirm({title:e.$t("messages.confirm"),content:e.$t("messages.confirm_save"),okText:e.$t("button.yes"),cancelText:e.$t("button.no"),onOk:function(){e.submitForm()}})}))},submitForm:function(){var e=this;this.$refs.form.validate(function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=5;break}return t.next=3,e.formData.save(e.$route.params.projectId);case 3:(n=t.sent).data&&n.data.success?e.isNew?(e.$Message.success({content:e.$t("pages.unit")+e.$t("messages.successfully_created"),duration:3}),e.$router.push({name:"projects-projectId-units",params:{projectId:e.$route.params.projectId}})):(e.$Message.success({content:e.$t("pages.unit")+e.$t("messages.successfully_updated"),duration:3}),e.$router.push({name:"projects-projectId-billings-billing_types",params:{projectId:e.$route.params.projectId}})):e.$Message.error({content:e.$t("messages.fail"),duration:8});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},m=r(9),component=Object(m.a)(_,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",{attrs:{"dis-hover":"",bordered:!1}},[r("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n      "+e._s(e.isNew?e.$t("button.new"):e.$t("button.edit"))+e._s(e.$t("pages.unit"))+"\n    ")]),e._v(" "),r("Card",{attrs:{"dis-hover":"",bordered:!1}},[r("Row",{attrs:{type:"flex",justify:"center"}},[r("Col",{attrs:{xs:24,sm:13}},[r("Form",{ref:"form",attrs:{rules:e.rules,model:e.formData.json}},[r("FormItem",{attrs:{prop:"name",label:e.$t("form.billing_type.label.bill_cycle")}},[r("Input",{attrs:{type:"text",placeholder:e.$t("form.billing_type.placeholder.bill_cycle")},model:{value:e.formData.json.name,callback:function(t){e.$set(e.formData.json,"name",t)},expression:"formData.json.name"}})],1),e._v(" "),r("Row",{attrs:{type:"flex",justify:"space-between"}},[r("Col",{attrs:{span:11}},[r("FormItem",{attrs:{prop:"from_date",label:e.$t("form.billing_type.label.from")}},[r("DatePicker",{attrs:{format:"dd/MM/yyyy",type:"date",placeholder:e.$t("form.billing_type.placeholder.from")},model:{value:e.formData.json.from_date,callback:function(t){e.$set(e.formData.json,"from_date",t)},expression:"formData.json.from_date"}})],1)],1),e._v(" "),r("Col",{attrs:{span:11}},[r("FormItem",{attrs:{prop:"to_date",label:e.$t("form.billing_type.label.to")}},[r("DatePicker",{attrs:{format:"dd/MM/yyyy",type:"date",placeholder:e.$t("form.billing_type.placeholder.to")},model:{value:e.formData.json.to_date,callback:function(t){e.$set(e.formData.json,"to_date",t)},expression:"formData.json.to_date"}})],1)],1)],1),e._v(" "),r("FormItem",{attrs:{prop:"month",label:e.$t("form.billing_type.label.month")}},[r("Input",{attrs:{type:"text",placeholder:e.$t("form.billing_type.placeholder.month")},model:{value:e.formData.json.month,callback:function(t){e.$set(e.formData.json,"month",t)},expression:"formData.json.month"}})],1),e._v(" "),r("FormItem",{attrs:{prop:"type",label:e.$t("form.billing_type.label.payment_type")}},[r("RadioGroup",{model:{value:e.formData.json.extra_detail_json.payment_calculation_by,callback:function(t){e.$set(e.formData.json.extra_detail_json,"payment_calculation_by",t)},expression:"\n                  formData.json.extra_detail_json.payment_calculation_by\n                "}},[r("Radio",{attrs:{label:"actual"}},[r("span",[e._v("Pay as Actual")])]),e._v(" "),r("Radio",{attrs:{label:"asset_type"}},[r("span",[e._v("Pay as Unit Type")])])],1)],1),e._v(" "),"actual"===e.formData.json.extra_detail_json.payment_calculation_by?r("FormItem",{attrs:{label:e.$t("form.billing_type.label.price_per_unit")}},[r("Input",{attrs:{type:"number",placeholder:e.$t("form.billing_type.placeholder.price_per_unit")},model:{value:e.formData.json.extra_detail_json.price_per_unit,callback:function(t){e.$set(e.formData.json.extra_detail_json,"price_per_unit",t)},expression:"formData.json.extra_detail_json.price_per_unit"}})],1):"asset_type"===e.formData.json.extra_detail_json.payment_calculation_by?r("FormItem",{attrs:{label:e.$t("form.billing_type.label.price_per_unit")}},e._l(e.unitTypes,(function(t,n){return r("Row",{key:n},[r("Input",{staticClass:"my-5",attrs:{type:"number",placeholder:e.$t("form.billing_type.placeholder.price_per_unit")},model:{value:e.formData.json.extra_detail_json.asset_types[n].price_per_unit,callback:function(t){e.$set(e.formData.json.extra_detail_json.asset_types[n],"price_per_unit",t)},expression:"\n                    formData.json.extra_detail_json.asset_types[index]\n                      .price_per_unit\n                  "}},[r("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v(e._s(t.name))])])],1)})),1):e._e(),e._v(" "),r("FormItem",{attrs:{align:"center"}},[r("Button",{staticClass:"default-button button-grey",attrs:{to:{name:"projects-projectId-units",params:{projectId:e.$route.params.projectId}}}},[e._v("\n                "+e._s(e.$t("button.cancel"))+"\n              ")]),e._v(" "),r("Button",{staticClass:"default-button button-green",on:{click:function(t){return e.handleSubmit()}}},[e._v("\n                "+e._s(e.$t("button.save"))+"\n              ")])],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,"7b789707",null);t.default=component.exports}}]);