(window.webpackJsonp=window.webpackJsonp||[]).push([[178],{406:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));n(15),n(18),n(32),n(33);var r=n(4),o=n(7),c=n(30),l=n(31),h=(n(21),n(25),n(3)),d=n(6),j=n(5);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var _=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.json=f(f({},t),{},{first_name_translations:t.first_name_translations||{en:"",th:""},last_name_translations:t.last_name_translations||{en:"",th:""},title_translations:t.title_translations||{en:"",th:""}})}var t,n,o,m,_,O,v;return Object(l.a)(e,[{key:"resetPassword",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("patch",Object(d.e)(d.b,"reset_password"),{data:{user:this.json},headers:Object(d.c)(!0)});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"forgetPassword",value:(O=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("patch",Object(d.e)(d.b,"forgot_password"),{data:{user:this.json},headers:Object(d.c)(!0)});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"save",value:(_=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,(r=Object(j.e)(this.json,"user")).juristic_person="yes"===r.juristic_person,o=Object(j.n)({user:r,addresses:t},null,["profile_image"]),!this.json.id){e.next=10;break}return e.next=7,Object(d.d)("patch",Object(d.e)(d.a,"users/".concat(this.json.id)),{headers:Object(d.c)(!0),data:o});case 7:n=e.sent,e.next=13;break;case 10:return e.next=12,Object(d.d)("post",Object(d.e)(d.a,"users"),{headers:Object(d.c)(!0),data:o});case 12:n=e.sent;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"asInfoJson",value:function(){return{addresses:this.json.addresses,no:this.json.no,customer_code:this.json.customer_code||"-",customer_type:this.json.customer_type||"-",date_of_birth:this.json.date_of_birth?Object(j.g)(this.json.date_of_birth):"-",display_name:this.json.display_name?this.json.display_name:"-",email:this.json.email||"-",facebook:this.json.facebook||"-",full_name:this.fullName(),gender:this.json.gender,id:this.json.id,issue_at:this.json.issue_at||"-",juristic_person:this.json.juristic_person,language:this.json.language||"-",line:this.json.line||"-",marital_status:this.json.marital_status,mobile_primary:this.json.mobile_primary||"-",mobile_secondary:this.json.mobile_secondary||"-",nationality:Object(h.startCase)(this.json.nationality),passport_country:this.json.passport_country||"-",passport_number:this.json.passport_number||"-",profile_image:this.json.profile_image||null,race:Object(h.startCase)(this.json.race),telephone_oversea:this.json.telephone_oversea||"-",telephone:this.json.telephone||"-",thai_id_number:this.json.thai_id_number||"-",user_assets:this.json.user_assets,wechat:this.json.wechat||"-",whatsapp:this.json.whatsapp||"-"}}},{key:"fullName",value:function(){var e=[],t=[];return this.json.first_name_translations&&Object.keys(this.json.first_name_translations).length>0&&(e.push(this.json.first_name_translations.th),t.push(this.json.first_name_translations.en)),this.json.last_name_translations&&Object.keys(this.json.last_name_translations).length>0&&(e.push(this.json.last_name_translations.th),t.push(this.json.last_name_translations.en)),{th:e.join(" "),en:t.join(" ")}}}],[{key:"index",value:(m=Object(r.a)(regeneratorRuntime.mark((function t(n,r,o,c){var l,j;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.d)("get",Object(d.e)(d.a,"projects/".concat(n,"/user_assets")),{params:{page:r,per_page:o,search:c},headers:Object(d.c)(!0)});case 2:if(200!==(l=t.sent).status){t.next=6;break}return j=Object(h.map)(l.data.users,(function(t){return new e(t)})),t.abrupt("return",{users:j,total_count:l.data.total_count});case 6:return t.abrupt("return",[]);case 7:case"end":return t.stop()}}),t)}))),function(e,t,n,r){return m.apply(this,arguments)})},{key:"show",value:(o=Object(r.a)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.d)("get",Object(d.e)(d.a,"users/".concat(n)),{headers:Object(d.c)(!0)});case 2:if(200!==(r=t.sent).status){t.next=5;break}return t.abrupt("return",new e(r.data.user));case 5:case"end":return t.stop()}}),t)}))),function(e){return o.apply(this,arguments)})},{key:"destroy",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("delete",Object(d.e)(d.a,"users/".concat(t)),{headers:Object(d.c)(!0)});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"importUserAssets",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("file",n),e.next=4,Object(d.d)("post",Object(d.e)(d.a,"projects/".concat(t,"/assets/import_user_assets")),{headers:Object(d.c)(!0,!0),data:r});case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e}()},498:function(e,t,n){var content=n(600);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("45ad4864",content,!0,{sourceMap:!1})},599:function(e,t,n){"use strict";n(498)},600:function(e,t,n){var r=n(22)(!1);r.push([e.i,"@media screen and (max-width:415px){[data-v-5df7a8dc] .ivu-card-extra{position:static;text-align:right}}",""]),e.exports=r},741:function(e,t,n){"use strict";n.r(t);var r=n(4),o=(n(25),n(108),n(3)),c=n(406),l={data:function(){return{isLoading:!0,loading:!1,residentManagements:[],currentPage:1,pageSize:10,search:"",totalPages:null,visibleModal:!1}},mounted:function(){this.fetchUsers()},methods:{fetchItems:function(e,t){this.currentPage=e,this.pageSize=t,this.fetchUsers(!0)},fetchUsers:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e?t.isLoading=!0:t.loading=!0,n.next=3,c.a.index(t.$route.params.projectId,t.currentPage,t.pageSize,t.search);case 3:r=n.sent,t.residentManagements=Object(o.map)(r.users,(function(u,e){return u.json.passport_number=u.json.passport_number||"-",u.json.mobile_primary=u.json.mobile_primary||"-",u.json.thai_id_number=u.json.thai_id_number||"-",u.json.no=(t.currentPage-1)*t.pageSize+(e+1),u.json})),t.totalPages=r.total_count,t.isLoading=!1,t.loading=!1;case 8:case"end":return n.stop()}}),n)})))()},searchItem:function(e){this.search=e,this.currentPage=1,this.fetchUsers()}}},h=(n(599),n(9)),component=Object(h.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isLoading?n("GLoading"):n("Card",{attrs:{"dis-hover":"",bordered:!1}},[n("div",{attrs:{slot:"title"},slot:"title"},[n("h3",[e._v("\n        "+e._s(e.$t("pages.resident_managements"))+"\n      ")])]),e._v(" "),n("GIndexPage",{attrs:{items:e.residentManagements,"show-sizer":"","search-by-api":"","current-page":e.currentPage,"page-size":e.pageSize,loading:e.loading,"new-button-name":e.$t("pages.resident_management"),component:"GResidentManagementTable","new-url":{name:"projects-projectId-resident_managements-new",params:{projectId:e.$route.params.projectId}},"total-pages":e.totalPages},on:{importData:function(t){e.visibleModal=!0},handleToSearchItem:e.searchItem,reloadData:e.fetchUsers,pageAndItemPerPage:e.fetchItems}}),e._v(" "),n("Modal",{attrs:{width:"60%","max-height":"600px","footer-hide":"",closable:!1,"mask-closable":!1},model:{value:e.visibleModal,callback:function(t){e.visibleModal=t},expression:"visibleModal"}},[n("GUploadResidentForm",{attrs:{"visible-modal":e.visibleModal},on:{reloadData:e.fetchUsers,closeModal:function(t){e.visibleModal=!1}}})],1)],1)],1)}),[],!1,null,"5df7a8dc",null);t.default=component.exports}}]);