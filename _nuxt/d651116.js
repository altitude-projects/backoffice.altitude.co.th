(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{416:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));n(21),n(15),n(18),n(32),n(33);var r=n(4),o=n(7),c=n(30),l=n(31),f=(n(25),n(3)),d=n(6),m=n(5);function v(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function h(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,t),this.json=h(h({},e),{},{name_translations:e.name_translations||{en:"",th:""},description_translations:e.description_translations||{en:"",th:""},maximum_limit:e.maximum_limit||""})}var e,n,o,v,_,y,j;return Object(l.a)(t,[{key:"save",value:(j=Object(r.a)(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,r=Object(m.e)(this.json,"facility"),r=Object(m.n)(r,"facility",["cover_image"]),!this.json.id){t.next=9;break}return t.next=6,Object(d.d)("patch",Object(d.e)(d.a,"projects/".concat(e,"/facilities/").concat(this.json.id)),{data:r,headers:Object(d.c)(!0)});case 6:n=t.sent,t.next=12;break;case 9:return t.next=11,Object(d.d)("post",Object(d.e)(d.a,"projects/".concat(e,"/facilities")),{data:r,headers:Object(d.c)(!0)});case 11:n=t.sent;case 12:return t.abrupt("return",n);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return j.apply(this,arguments)})},{key:"activate",value:(y=Object(r.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.d)("patch",Object(d.e)(d.a,"projects/".concat(e,"/facilities/").concat(this.json.id,"/activate")),{headers:Object(d.c)(!0)});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"inactivate",value:(_=Object(r.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.d)("patch",Object(d.e)(d.a,"projects/".concat(e,"/facilities/").concat(this.json.id,"/inactivate")),{headers:Object(d.c)(!0)});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"asTableJson",value:function(){return{id:this.json.id,name_en:this.json.name_translations.en||"",name_th:this.json.name_translations.th||"",maximum_limit:this.json.maximum_limit||"",sorting_index:this.json.sorting_index||"",status:this.json.status,cover_image:this.json.cover_image?this.json.cover_image.url:"",name_translations:this.json.name_translations,description_translations:this.json.description_translations,facility_bookings:this.json.facility_bookings}}}],[{key:"index",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("get",Object(d.e)(d.a,"projects/".concat(n,"/facilities")),{headers:Object(d.c)(!0)});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",Object(f.map)(r.data.facilities,(function(e){return new t(e)})));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)}))),function(t){return v.apply(this,arguments)})},{key:"scheduleIndex",value:(o=Object(r.a)(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("get",Object(d.e)(d.a,"projects/".concat(n,"/facilities/schedule_index")),{params:{schedule_date:r},headers:Object(d.c)(!0)});case 2:if(200!==(o=e.sent).status){e.next=5;break}return e.abrupt("return",Object(f.map)(o.data.facilities,(function(e){return new t(e)})));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)}))),function(t,e){return o.apply(this,arguments)})},{key:"bookingHistories",value:(n=Object(r.a)(regeneratorRuntime.mark((function t(e,n,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.d)("get",Object(d.e)(d.a,"projects/".concat(e,"/facilities/").concat(n,"/booking_histories")),{params:{schedule_date:r},headers:Object(d.c)(!0)});case 2:if(200!==(o=t.sent).status){t.next=5;break}return t.abrupt("return",o);case 5:return t.abrupt("return",[]);case 6:case"end":return t.stop()}}),t)}))),function(t,e,r){return n.apply(this,arguments)})},{key:"show",value:(e=Object(r.a)(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("get",Object(d.e)(d.a,"projects/".concat(n,"/facilities/").concat(r)),{headers:Object(d.c)(!0)});case 2:if(200!==(o=e.sent).status){e.next=5;break}return e.abrupt("return",new t(o.data.facility));case 5:return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),function(t,n){return e.apply(this,arguments)})}]),t}()},446:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));n(21),n(15),n(18),n(32),n(33);var r=n(4),o=n(7),c=n(30),l=n(31),f=(n(25),n(3)),d=n(6),m=n(5);function v(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function h(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,t),this.json=h(h({},e),{},{facility_id:"",number_of_user:""})}var e,n,o;return Object(l.a)(t,[{key:"save",value:(o=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,o=Object(m.e)(this.json,"facilityBooking"),!this.json.id){t.next=8;break}return t.next=5,Object(d.d)("patch",Object(d.e)(d.a,"projects/".concat(e,"/facilities/").concat(n,"/facility_bookings/").concat(this.json.id)),{data:{facility_booking:o},headers:Object(d.c)(!0)});case 5:r=t.sent,t.next=11;break;case 8:return t.next=10,Object(d.d)("post",Object(d.e)(d.a,"projects/".concat(e,"/facilities/").concat(n,"/facility_bookings")),{data:{facility_booking:o},headers:Object(d.c)(!0)});case 10:r=t.sent;case 11:return t.abrupt("return",r);case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"cancel",value:(n=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.d)("patch",Object(d.e)(d.a,"projects/".concat(e,"/facilities/").concat(n,"/facility_bookings/").concat(this.json.id,"/cancel")),{headers:Object(d.c)(!0)});case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})}],[{key:"index",value:(e=Object(r.a)(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("get",Object(d.e)(d.a,"projects/".concat(n,"/facilities/").concat(r,"/facility_bookings")),{headers:Object(d.c)(!0)});case 2:if(200!==(o=e.sent).status){e.next=5;break}return e.abrupt("return",Object(f.map)(o.data.facility_bookings,(function(e){return new t(e)})));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)}))),function(t,n){return e.apply(this,arguments)})}]),t}()},502:function(t,e,n){var content=n(608);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(23).default)("2ff11462",content,!0,{sourceMap:!1})},607:function(t,e,n){"use strict";n(502)},608:function(t,e,n){var r=n(22)(!1);r.push([t.i,"[data-v-19409fae] .ivu-card-head{padding:14px 0;margin-bottom:7px}[data-v-19409fae] table,td[data-v-19409fae],th[data-v-19409fae]{border:1px solid #e3e3e3}[data-v-19409fae] table{width:100%;border-collapse:collapse}td[data-v-19409fae],th[data-v-19409fae]{height:53px;padding:5px}",""]),t.exports=r},747:function(t,e,n){"use strict";n.r(e);var r=n(4),o=(n(11),n(25),n(3)),c=n(1),l=n.n(c),f=n(416),d=n(446),m=n(5),v={data:function(){return{datetime:new Date,editFacilityBooking:{},facilities:[],facilitieHistories:[],visible:!1,facilityBooking:null,visibleFacilityBooking:!1,visibleHistory:!1,showActionColumn:!1}},watch:{datetime:function(t,e){t&&(this.showActionColumn=l()(t).format("DD MMMM yyyy")>=l()().format("DD MMMM yyyy"))}},mounted:function(){this.datetime=l()().format("DD MMMM yyyy"),this.fetchFacilities()},methods:{moment:l.a,padStart:o.padStart,fetchFacilities:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.scheduleIndex(t.$route.params.projectId,Object(m.g)(t.datetime));case 2:n=e.sent,t.facilities=Object(o.map)(n,(function(t){return t.asTableJson()}));case 4:case"end":return e.stop()}}),e)})))()},fetchFacilitieHistories:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.bookingHistories(e.$route.params.projectId,t,Object(m.g)(e.datetime));case 2:r=n.sent,e.facilitieHistories=r.data.booking_histories;case 4:case"end":return n.stop()}}),n)})))()},setFacility:function(t,e,n){this.facilityBooking={facility_name:t,facility_bookings:e,maximum_limit:n},this.visible=!0},handleCancel:function(t){var e=this;return new Promise((function(n){var o;e.$Modal.confirm({title:e.$t("messages.confirm_save"),okText:e.$t("button.yes"),cancelText:e.$t("button.no"),onOk:(o=Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=new d.a(t),n.next=3,r.cancel(e.$route.params.projectId,t.facility_id);case 3:n.sent.data.success&&(e.visible=!1,e.fetchFacilities());case 5:case"end":return n.stop()}}),n)}))),function(){return o.apply(this,arguments)})})}))},handleEditSchedule:function(t){this.editFacilityBooking=t,this.editFacilityBooking.maximum_limit=this.facilityBooking.maximum_limit,this.visible=!1,this.visibleFacilityBooking=!0}}},h=(n(607),n(9)),component=Object(h.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{staticClass:"mx-25",attrs:{bordered:!1,"dis-hover":!0,padding:0}},[n("div",{attrs:{slot:"title"},slot:"title"},[n("h3",[t._v(t._s(t.$t("button.schedule")))])]),t._v(" "),n("Row",{attrs:{type:"flex",justify:"space-between"}},[n("Col",{staticClass:"mb-10"},[n("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"Select date",format:"dd MMMM yyyy",size:"small"},on:{"on-change":function(e){return t.fetchFacilities()}},model:{value:t.datetime,callback:function(e){t.datetime=e},expression:"datetime"}})],1),t._v(" "),n("Col",[n("Button",{staticClass:"button-orange",attrs:{size:"small"},on:{click:function(e){t.visibleHistory=!0}}},[t._v("\n        "+t._s(t.$t("button.booking_history"))+"\n      ")]),t._v(" "),n("Modal",{attrs:{width:"1000","footer-hide":""},model:{value:t.visibleHistory,callback:function(e){t.visibleHistory=e},expression:"visibleHistory"}},[n("GScheduleHistoryTable",{attrs:{items:t.facilitieHistories,facilities:t.facilities},on:{fetchFacilityHistories:t.fetchFacilitieHistories}})],1),t._v(" "),n("Button",{staticClass:"button-orange",attrs:{size:"small"},on:{click:function(e){t.visibleFacilityBooking=!0}}},[t._v("\n        "+t._s(t.$t("button.book_now"))+"\n      ")]),t._v(" "),n("Modal",{attrs:{"footer-hide":"",closable:!1,"mask-closable":!1},model:{value:t.visibleFacilityBooking,callback:function(e){t.visibleFacilityBooking=e},expression:"visibleFacilityBooking"}},[n("GFacilityBookingForm",{attrs:{"default-date":t.datetime,facilities:t.facilities,"visible-modal":t.visibleFacilityBooking,"edit-facility-booking":t.editFacilityBooking},on:{closeModal:function(e){t.visibleFacilityBooking=!1,t.fetchFacilities()}}})],1)],1)],1),t._v(" "),n("div",{staticStyle:{width:"100%",overflow:"scroll","padding-top":"10px","padding-bottom":"10px"}},[n("table",{staticClass:"mt-10"},[n("thead",[n("tr",[n("th",{staticStyle:{"min-width":"200px"},attrs:{rowspan:"2"}},[t._v("\n            "+t._s(t.$t("info.facility.label.facility_name"))+"\n          ")]),t._v(" "),t._l(24,(function(e){return n("th",{key:e,staticStyle:{"min-width":"100px"},attrs:{colspan:"2"}},[t._v("\n            "+t._s(t.padStart(e-1,2,"0"))+"\n          ")])}))],2),t._v(" "),n("tr",t._l(48,(function(e,i){return n("th",{key:e,staticStyle:{"min-width":"50px"}},[n("span",i%2==0?[t._v("00")]:[t._v("30")])])})),0)]),t._v(" "),n("tbody",t._l(t.facilities,(function(e){return n("tr",{key:e.id},[n("td",{style:{minWidth:"200px",background:"inactive"===e.status?"#F1F1F1":"#FFFFFF"}},[t._v("\n            "+t._s(e.name_translations[t.$store.state.language.value])+"\n          ")]),t._v(" "),t._l(e.facility_bookings,(function(r,o){return n("td",{key:"booking_"+o,staticClass:"text-center",style:{minWidth:"50px",background:"inactive"===e.status?"#F1F1F1":"#FFFFFF"}},[e.maximum_limit===r.booking_count?n("span",{staticStyle:{cursor:"pointer"},on:{click:function(n){return t.setFacility(e.name_translations[t.$store.state.language.value],r.booking_information,e.maximum_limit)}}},[n("Icon",{attrs:{type:"md-person",color:"#F45151"}}),n("br"),t._v(" "),n("span",{staticClass:"font-size-12",staticStyle:{color:"#f45151"}},[t._v("\n                "+t._s(r.booking_count)+"\n              ")])],1):0!==r.booking_count?n("span",{staticStyle:{cursor:"pointer"},on:{click:function(n){return t.setFacility(e.name_translations[t.$store.state.language.value],r.booking_information,e.maximum_limit)}}},[n("Icon",{attrs:{type:"md-person",color:"#57BA5B"}}),n("br"),t._v(" "),n("span",{staticClass:"font-size-12",staticStyle:{color:"#57ba5b"}},[t._v("\n                "+t._s(r.booking_count)+"\n              ")])],1):t._e()])}))],2)})),0)])]),t._v(" "),n("Modal",{attrs:{"footer-hide":"",closable:!1,"mask-closable":!1,width:"580"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.facilityBooking?n("Card",{attrs:{bordered:!1,"dis-hover":!0,padding:0}},[n("div",{attrs:{slot:"title"},slot:"title"},[n("h3",[t._v("\n          "+t._s(t.facilityBooking.facility_name)+"\n        ")])]),t._v(" "),n("div",{attrs:{slot:"extra"},slot:"extra"}),t._v(" "),n("p",[t._v("\n        "+t._s(t.moment(t.datetime).locale(t.$store.state.language.value).format("DD MMMM yyyy"))+"\n      ")]),t._v(" "),n("div",{staticStyle:{overflow:"auto"}},[n("table",[n("thead",{staticStyle:{background:"#e69a86"}},[n("tr",[n("th",{staticStyle:{width:"100px"}},[t._v("\n                "+t._s(t.$t("info.booking_schedule.label.booking_name"))+"\n              ")]),t._v(" "),n("th",{staticStyle:{width:"90px"}},[t._v("\n                "+t._s(t.$t("info.booking_schedule.label.number_of_user"))+"\n              ")]),t._v(" "),n("th",{staticStyle:{width:"150px"}},[t._v("\n                "+t._s(t.$t("info.booking_schedule.label.user_address_number"))+"\n              ")]),t._v(" "),n("th",{staticStyle:{width:"150px"}},[t._v("\n                "+t._s(t.$t("info.booking_schedule.label.booking_time"))+"\n              ")]),t._v(" "),n("th",[t._v(t._s(t.$t("info.booking_schedule.label.status")))]),t._v(" "),n("th",{directives:[{name:"show",rawName:"v-show",value:t.showActionColumn,expression:"showActionColumn"}],staticStyle:{width:"80px"}},[t._v("\n                "+t._s(t.$t("info.booking_schedule.label.action"))+"\n              ")])])]),t._v(" "),n("tbody",t._l(t.facilityBooking.facility_bookings,(function(e){return n("tr",{key:e.id},[n("td",[t._v("\n                "+t._s(e.user["full_name_"+t.$store.state.language.value])+"\n              ")]),t._v(" "),n("td",{staticClass:"text-center"},[t._v(t._s(e.number_of_user||"-"))]),t._v(" "),n("td",{staticClass:"text-center"},[t._v(t._s(e.user_address_number||"-"))]),t._v(" "),n("td",{staticClass:"text-center"},[t._v("\n                "+t._s(t.moment(e.start_datetime||"-").locale(t.$store.state.language.value).format("HH:mm"))+"\n                -\n                "+t._s(t.moment(e.end_datetime||"-").locale(t.$store.state.language.value).format("HH:mm"))+"\n              ")]),t._v(" "),n("td",{staticClass:"text-center"},[n("GStatusLabelPreview",{attrs:{status:e.status}})],1),t._v(" "),n("td",{directives:[{name:"show",rawName:"v-show",value:t.showActionColumn,expression:"showActionColumn"}],staticClass:"text-center"},[n("Row",{attrs:{type:"flex",justify:"center"}},[n("Col",[n("Tooltip",{attrs:{content:t.$t("button.edit"),placement:"top"}},[n("Icon",{staticStyle:{cursor:"pointer"},attrs:{type:"ios-create-outline",size:"20"},on:{click:function(n){return t.handleEditSchedule(e)}}})],1),t._v(" "),n("Tooltip",{attrs:{content:t.$t("button.cancel"),placement:"top"}},[n("Icon",{staticStyle:{cursor:"pointer"},attrs:{type:"ios-trash-outline",size:"20"},on:{click:function(n){return t.handleCancel(e)}}})],1)],1)],1)],1)])})),0)])])]):t._e(),t._v(" "),n("Row",{staticClass:"mt-10",attrs:{type:"flex",justify:"center"}},[n("Col",[n("Button",{staticClass:"default-button button-grey",attrs:{size:"small"},on:{click:function(e){t.visible=!1}}},[t._v("\n          "+t._s(t.$t("button.cancel"))+"\n        ")])],1)],1)],1)],1)}),[],!1,null,"19409fae",null);e.default=component.exports}}]);