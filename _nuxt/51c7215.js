(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{408:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));n(21),n(15),n(18),n(32),n(33);var r=n(4),c=n(7),o=n(30),l=n(31),m=(n(303),n(16),n(25),n(3)),_=n(1),d=n.n(_),f=n(6),j=n(5);function h(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,e),this.json=y(y({},t),{},{price_per_unit:t.price_per_unit?Object(j.m)(t.price_per_unit):""})}var t,n,c,_,h,v,O,x,k,w,$;return Object(l.a)(e,[{key:"save",value:($=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,c=Object(j.e)(this.json,"otherBilling"),!this.json.id){e.next=8;break}return e.next=5,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/")),{data:c,headers:Object(f.c)(!0)});case 5:r=e.sent,e.next=11;break;case 8:return e.next=10,Object(f.d)("post",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/")),{data:c,headers:Object(f.c)(!0)});case 10:r=e.sent;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return $.apply(this,arguments)})},{key:"generateWaterBill",value:(w=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){var c,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=null,(o=Object(m.cloneDeep)(this.json)).billing_cycle=this.json.billing_cycle?d()(this.json.billing_cycle).unix():null,o.due_datetime=this.json.due_datetime?d()(this.json.due_datetime).unix():null,o.price_per_unit=this.json.price_per_unit?Number(this.json.price_per_unit):null,o.from_datetime=this.json.from_datetime?d()(this.json.from_datetime).unix():null,o.to_datetime=this.json.to_datetime?d()(this.json.to_datetime).unix():null,o=Object(m.pickBy)(o,m.isNil),e.next=10,Object(f.d)("post",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/generate_asset_billings")),{data:y({billing:o},r),headers:Object(f.c)(!0)});case 10:return c=e.sent,e.abrupt("return",c);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return w.apply(this,arguments)})},{key:"update",value:(k=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(j.e)(this.json,"billing"),e.next=3,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/").concat(this.json.id)),{data:{billing:r},headers:Object(f.c)(!0)});case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"asTableJson",value:function(){return{asset:this.json.asset,asset_id:this.json.asset_id,address_number:this.json.asset?this.json.asset.address_number:"",asset_number:this.json.asset?this.json.asset.asset_number:"",building:this.json.asset?this.json.asset.building:"",floor:this.json.asset?this.json.asset.floor:"",usable_area:this.json.asset?Object(j.m)(this.json.asset.usable_area):"",area_for_maintenance_fee_calculation:this.json.asset?Object(j.m)(this.json.asset.area_for_maintenance_fee_calculation):"",asset_type:this.json.asset&&this.json.asset.asset_type?this.json.asset.asset_type.name:"",asset_model:this.json.asset&&this.json.asset.asset_model?this.json.asset.asset_model:"-",billing_cycle_month:this.json.billing_cycle?this.json.billing_cycle.month:"",actual_unit_price:this.json.asset?Object(j.c)(Object(j.m)(this.json.asset.area_for_maintenance_fee_calculation)*Object(j.m)(this.json.price_per_unit)):"",area:this.json.asset?Object(j.m)(this.json.asset.area):"",amount:this.json.amount?Object(j.c)(this.json.amount):"-",name:this.json.name,no:this.json.no,billing_cycle:this.json.billing_cycle?this.json.billing_cycle.name:null,billing_type_id:this.json.billing_type_id,created_at:this.json.created_at,from_datetime:Object(j.g)(this.json.from_datetime),from_datetime_invoice:Object(j.g)(this.json.from_datetime,"YYYY/MM/DD"),id:this.json.id,price_per_unit:this.json.price_per_unit?Object(j.c)(this.json.price_per_unit):"-",status:this.json.status,to_datetime:Object(j.g)(this.json.to_datetime),to_datetime_invoice:Object(j.g)(this.json.to_datetime,"YYYY/MM/DD"),total_price:Object(j.c)(this.json.total_price)||"-",unit:this.json.unit,payment_type:this.json.billing_cycle?this.json.billing_cycle.extra_detail_json.payment_calculation_by:"",previous_meter:Object(m.isNil)(this.json.previous_meter)?"-":this.json.previous_meter,current_meter:Object(m.isNil)(this.json.current_meter)?"-":this.json.current_meter,billing_type:this.json.billing_type,billing_owner:this.json.have_owner}}}],[{key:"typesIndex",value:(x=Object(r.a)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(n,"/billing_types")),{headers:Object(f.c)(!0)});case 2:if(200!==(r=t.sent).status){t.next=5;break}return t.abrupt("return",Object(m.map)(r.data.billing_types,(function(t){return new e(t)})));case 5:return t.abrupt("return",[]);case 6:case"end":return t.stop()}}),t)}))),function(e){return x.apply(this,arguments)})},{key:"index",value:(O=Object(r.a)(regeneratorRuntime.mark((function t(n,r,c){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(n,"/billing_types/").concat(r,"/billings/")),{params:{billing_cycle_name:c},headers:Object(f.c)(!0)});case 2:if(200!==(o=t.sent).status){t.next=5;break}return t.abrupt("return",Object(m.map)(o.data.billings,(function(t,n){return t.no=n+1,new e(t)})));case 5:return t.abrupt("return",[]);case 6:case"end":return t.stop()}}),t)}))),function(e,t,n){return O.apply(this,arguments)})},{key:"billingsByStatus",value:(v=Object(r.a)(regeneratorRuntime.mark((function t(n,r,c,o,l,_,d,j){var h,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(n,"/billing_types/").concat(r,"/billings/billings_by_status")),{params:{billing_cycle_name:c,status:o,query_date:l,page:_,per_page:d,search:j},headers:Object(f.c)(!0)});case 2:if(200!==(h=t.sent).status){t.next=6;break}return y=Object(m.map)(h.data.billings,(function(t){return new e(t)})),t.abrupt("return",{billings:y,total_count:h.data.total_count});case 6:return t.abrupt("return",[]);case 7:case"end":return t.stop()}}),t)}))),function(e,t,n,r,c,o,l,m){return v.apply(this,arguments)})},{key:"billingsCountByStatus",value:(h=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r,c){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/billings_count_by_status")),{params:{billing_cycle_name:r,query_date:c},headers:Object(f.c)(!0)});case 2:if(200!==(o=e.sent).status){e.next=5;break}return e.abrupt("return",o.data.billings);case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return h.apply(this,arguments)})},{key:"updateBillings",value:(_=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){var c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/update_billings")),{data:{billings:r},headers:Object(f.c)(!0)});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return _.apply(this,arguments)})},{key:"cancel",value:(c=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){var c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/").concat(r,"/cancel")),{headers:Object(f.c)(!0)});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"finalize",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){var c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/").concat(r,"/finalize")),{headers:Object(f.c)(!0)});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"finalizeBillings",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){var c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(t,"/billing_types/").concat(n,"/billings/finalize_billings")),{params:{billing_ids:r},headers:Object(f.c)(!0)});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}()},409:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n(21),n(15),n(18),n(32),n(33);var r=n(4),c=n(7),o=n(30),l=n(31),m=(n(16),n(25),n(3)),_=n(6),d=n(5);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function j(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,e),this.json=j(j({},t),{},{area:t.area||0})}var t,n,c,f,h,y,v;return Object(l.a)(e,[{key:"save",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,r=Object(d.e)(this.json,"unit"),!this.json.id){e.next=8;break}return e.next=5,Object(_.d)("patch",Object(_.e)(_.a,"projects/".concat(t,"/assets/").concat(this.json.id)),{headers:Object(_.c)(!0),data:r});case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,Object(_.d)("post",Object(_.e)(_.a,"projects/".concat(t,"/assets")),{headers:Object(_.c)(!0),data:r});case 10:n=e.sent;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"asTableJson",value:function(e,t){return{id:this.json.id,no:(t-1)*e+this.json.no,address_number:this.json.address_number||"-",asset_number:this.json.asset_number||"-",asset_model:this.json.asset_model||"-",asset_type_name:this.json.asset_type.name,building:this.json.building||"-",usable_area:this.json.usable_area||"-",area:this.json.area||"-",phase:this.json.phase||"-",floor:this.json.floor||"-",property_type:this.json.property_type||"-"}}}],[{key:"index",value:(y=Object(r.a)(regeneratorRuntime.mark((function t(n,r,c,o){var l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.d)("get",Object(_.e)(_.a,"projects/".concat(n,"/assets")),{headers:Object(_.c)(!0),params:{search:r,page:c,per_page:o}});case 2:if(l=t.sent,d=Object(m.orderBy)(l.data.assets,["address_number"],["asc"]),200!==l.status){t.next=7;break}return d=Object(m.map)(d,(function(t,n){return t.no=n+1,new e(t)})),t.abrupt("return",{units:d,total_count:l.data.total_count});case 7:return t.abrupt("return",[]);case 8:case"end":return t.stop()}}),t)}))),function(e,t,n,r){return y.apply(this,arguments)})},{key:"show",value:(h=Object(r.a)(regeneratorRuntime.mark((function t(n,r){var c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.d)("get",Object(_.e)(_.a,"projects/".concat(n,"/assets/").concat(r)),{headers:Object(_.c)(!0)});case 2:if(200!==(c=t.sent).status){t.next=5;break}return t.abrupt("return",new e(c.data.asset));case 5:case"end":return t.stop()}}),t)}))),function(e,t){return h.apply(this,arguments)})},{key:"destroy",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)("delete",Object(_.e)(_.a,"projects/".concat(t,"/assets/").concat(n)),{headers:Object(_.c)(!0)});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return f.apply(this,arguments)})},{key:"assetBillings",value:(c=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)("get",Object(_.e)(_.a,"projects/".concat(t,"/assets/").concat(n,"/asset_billings")),{headers:Object(_.c)(!0)});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)})},{key:"importAssets",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("file",n),e.next=4,Object(_.d)("post",Object(_.e)(_.a,"projects/".concat(t,"/assets/import_assets")),{headers:Object(_.c)(!0,!0),data:r});case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"importAssetSupplies",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){var c,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=new FormData).append("file",n),c.append("images_zip_file",r),e.next=5,Object(_.d)("post",Object(_.e)(_.a,"projects/".concat(t,"/assets/import_asset_supplies")),{headers:Object(_.c)(!0,!0),data:c});case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}()},410:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(4),c=n(30),o=n(31),l=(n(25),n(3)),m=n(6),_=n(5),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.json=t}var t,n,d,f,j,h;return Object(o.a)(e,[{key:"save",value:(h=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,r=Object(_.e)(this.json,"unitType"),!this.json.id){e.next=8;break}return e.next=5,Object(m.d)("patch",Object(m.e)(m.a,"projects/".concat(t,"/asset_types/").concat(this.json.id)),{headers:Object(m.c)(!0),data:r});case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,Object(m.d)("post",Object(m.e)(m.a,"projects/".concat(t,"/asset_types")),{headers:Object(m.c)(!0),data:r});case 10:n=e.sent;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"activate",value:(j=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)("patch",Object(m.e)(m.a,"projects/".concat(t,"/asset_types/").concat(this.json.id,"/activate")),{headers:Object(m.c)(!0)});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"inactivate",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)("patch",Object(m.e)(m.a,"projects/".concat(t,"/asset_types/").concat(this.json.id,"/inactivate")),{headers:Object(m.c)(!0)});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})}],[{key:"unitTypeForSelect",value:(d=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.d)("get",Object(m.e)(m.a,"projects/".concat(t,"/asset_types/asset_types_for_select")),{headers:Object(m.c)(!0)});case 2:if(200!==(n=e.sent).status){e.next=5;break}return e.abrupt("return",n.data.asset_types);case 5:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})},{key:"index",value:(n=Object(r.a)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.d)("get",Object(m.e)(m.a,"projects/".concat(n,"/asset_types")),{headers:Object(m.c)(!0)});case 2:if(200!==(r=t.sent).status){t.next=5;break}return t.abrupt("return",Object(l.map)(r.data.asset_types,(function(t,n){return t.no=n+1,new e(t,n)})));case 5:return t.abrupt("return",[]);case 6:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)})},{key:"show",value:(t=Object(r.a)(regeneratorRuntime.mark((function t(n,r){var c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.d)("get",Object(m.e)(m.a,"projects/".concat(n,"/asset_types/").concat(r)),{headers:Object(m.c)(!0)});case 2:if(200!==(c=t.sent).status){t.next=5;break}return t.abrupt("return",new e(c.data.asset_type));case 5:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)})}]),e}()},791:function(e,t,n){"use strict";n.r(t);var r=n(4),c=(n(11),n(303),n(25),n(3)),o=n(5),l=n(408),m=n(410),_=n(409),d={props:{title:{type:String,default:function(){return""}},billingTypeKey:{type:String,default:function(){return""}},visibleModal:{type:Boolean,default:function(){return!1}}},data:function(){return{formData:{billing:new l.a,payByAssetType:!1,assetTypes:[],billingPricePerUnit:"",payByAssetTypeValue:""},unitTypes:[],units:[],selectedUnit:{}}},watch:{billingTypeKey:function(){"other_billing"===this.billingTypeKey&&this.fetchUnits()},visibleModal:function(e,t){e||this.$nextTick((function(){this.$refs.billing.resetFields()}))}},mounted:function(){this.setPayByAssetType("pay_as_actual")},methods:{convertPrice:o.c,handleClose:function(){this.$nextTick((function(){this.$refs.billing.resetFields()})),this.$emit("closeModal")},setPayByAssetType:function(e){this.formData.payByAssetType="pay_as_unit_type"===e,this.formData.payByAssetTypeValue=e,this.formData.payByAssetType&&this.fetchUnitTypes()},fetchUnitTypes:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.unitTypeForSelect(e.$route.params.projectId);case 2:(n=t.sent)&&(e.unitTypes=n,e.formData.assetTypes=Object(c.map)(e.unitTypes,(function(e){return{id:e.id,price_per_unit:""}})));case 4:case"end":return t.stop()}}),t)})))()},fetchUnits:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.index(e.$route.params.projectId);case 2:n=t.sent,e.units=Object(c.map)(n.units,(function(u){return u.json}));case 4:case"end":return t.stop()}}),t)})))()},handleSelectedUnit:function(data){this.selectedUnit=Object(c.find)(this.units,(function(e){return e.id===data.value}))},convertTotalPrice:function(){var e=this.formData.billing.json,t=e.price_per_unit*e.amount||"";return this.formData.billing.json.total_price=t,Object(o.c)(t)},handleSubmit:function(){var e=this;return new Promise((function(t){e.$Modal.confirm({title:e.$t("messages.are_you_sure"),content:e.$t("messages.confirm_save"),okText:e.$t("button.yes"),cancelText:e.$t("button.no"),onOk:function(){e.submitForm()}})}))},submitForm:function(){var e=this;this.$refs.billing.validate(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(n){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=14;break}if(r={},o={},"other_billing"!==e.billingTypeKey){t.next=9;break}return t.next=6,e.formData.billing.save(e.$route.params.projectId,e.$route.params.billingId,r);case 6:o=t.sent,t.next=13;break;case 9:return"maintenance_fee"===e.billingTypeKey&&(r={pay_by_asset_type:e.formData.payByAssetType,asset_types:Object(c.map)(e.formData.assetTypes,(function(e){return e.price_per_unit=Number(e.price_per_unit),e})),billing_price_per_unit:e.formData.billingPricePerUnit?Number(e.formData.billingPricePerUnit):null}),t.next=12,e.formData.billing.generateWaterBill(e.$route.params.projectId,e.$route.params.billingId,r);case 12:o=t.sent;case 13:o.data&&o.data.success?(e.$Message.success({content:e.$t("pages.billing")+e.$t("messages.successfully_created"),duration:3}),e.handleClose()):e.$Message.error({content:e.$t("messages.fail"),duration:8});case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},f=n(9),component=Object(f.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Card",{attrs:{"dis-hover":"",bordered:!1}},[n("p",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.title))]),e._v(" "),n("Form",{ref:"billing",attrs:{model:e.formData,"label-position":"top"}},["water_billing"===e.billingTypeKey?n("FormItem",{attrs:{prop:"billing.json.billing_cycle",label:e.$t("form.billing.label.billing_cycle"),rules:[{trigger:"blur,change",type:"date",required:!0,message:e.$t("form.billing.label.billing_cycle")+" "+e.$t("error.cannot_be_blank")}]}},[n("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"month",format:"MMMM yyyy"},model:{value:e.formData.billing.json.billing_cycle,callback:function(t){e.$set(e.formData.billing.json,"billing_cycle",t)},expression:"formData.billing.json.billing_cycle"}})],1):e._e(),e._v(" "),"other_billing"===e.billingTypeKey?[n("FormItem",{class:[e.selectedUnit&&e.selectedUnit.id?"mb-5":""],attrs:{prop:"billing.json.asset_id",label:e.$t("form.billing.label.address_no"),rules:[{trigger:"blur,change",required:!0,message:e.$t("form.billing.label.address_no")+" "+e.$t("error.cannot_be_blank")}]}},[n("Select",{staticStyle:{width:"200px"},attrs:{"not-found-text":e.$t("pages.no_data"),filterable:"",clearable:"",placeholder:e.$t("form.billing.placeholder.address_no")},on:{"on-select":e.handleSelectedUnit},model:{value:e.formData.billing.json.asset_id,callback:function(t){e.$set(e.formData.billing.json,"asset_id",t)},expression:"formData.billing.json.asset_id"}},e._l(e.units,(function(t){return n("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.asset_number||t.address_number))])})),1)],1),e._v(" "),"other_billing"===e.billingTypeKey&&e.selectedUnit&&e.selectedUnit.id&&e.formData.billing.json.asset_id?n("Row",{staticClass:"my-10"},[n("Col",{attrs:{xs:24,sm:12,md:12}},[n("span",{staticClass:"font-size-12"},[e._v("\n            "+e._s(e.$t("info.billing.label.address"))+":\n          ")]),e._v("\n          "+e._s(e.selectedUnit.address_number)+"\n          "),n("br"),e._v(" "),n("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("info.billing.label.unit_type"))+": ")]),e._v(e._s(e.selectedUnit.asset_type&&e.selectedUnit.asset_type.name)+"\n        ")]),e._v(" "),n("Col",{attrs:{xs:24,sm:12,md:12}},["condominium"===e.$store.state.project.project_type?n("div",[n("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("info.billing.label.floor"))+": ")]),e._v(e._s(e.selectedUnit.floor)+"\n            "),n("br"),e._v(" "),n("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("info.billing.label.building"))+": ")]),e._v(e._s(e.selectedUnit.building)+"\n          ")]):n("div",[n("span",{staticClass:"font-size-12"},[e._v("\n              "+e._s(e.$t("info.billing.label.phase"))+":\n            ")]),e._v("\n            "+e._s(e.selectedUnit.phase)+"\n            "),n("br"),e._v(" "),n("span",{staticClass:"font-size-12"},[e._v(e._s(e.$t("info.billing.label.asset_model"))+": ")]),e._v(e._s(e.selectedUnit.asset_model)+"\n          ")])])],1):e._e(),e._v(" "),n("FormItem",{attrs:{prop:"billing.json.name",label:e.$t("form.billing.label.billing_name"),rules:[{trigger:"blur,change",required:!0,message:e.$t("form.billing.label.billing_name")+" "+e.$t("error.cannot_be_blank")}]}},[n("Input",{attrs:{placeholder:e.$t("form.billing.placeholder.billing_name")},model:{value:e.formData.billing.json.name,callback:function(t){e.$set(e.formData.billing.json,"name",t)},expression:"formData.billing.json.name"}})],1)]:e._e(),e._v(" "),n("Row",[n("Col",{staticClass:"pr-5",attrs:{xs:24,sm:24,md:"other_billing"===e.billingTypeKey?12:24}},[n("FormItem",{attrs:{prop:"billing.json.from_datetime",label:e.$t("form.billing.label.from"),rules:[{trigger:"blur,change",required:!0,type:"date",message:e.$t("form.billing.label.from")+e.$t("error.cannot_be_blank")},{required:!0,trigger:"change,blur",type:"date",validator:function(t,n,r){e.formData.billing.json.to_datetime&&n&&n>e.formData.billing.json.to_datetime?r(e.$t("messages.invalid_start_date")):r()}}]}},[n("DatePicker",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("form.billing.placeholder.from"),type:"date",format:"dd/MM/yyyy"},model:{value:e.formData.billing.json.from_datetime,callback:function(t){e.$set(e.formData.billing.json,"from_datetime",t)},expression:"formData.billing.json.from_datetime"}})],1)],1),e._v(" "),n("Col",{staticClass:"pl-5",attrs:{xs:24,sm:24,md:"other_billing"===e.billingTypeKey?12:24}},[n("FormItem",{attrs:{prop:"billing.json.to_datetime",label:e.$t("form.billing.label.to"),rules:[{trigger:"blur,change",required:!0,type:"date",message:e.$t("form.billing.label.to")+e.$t("error.cannot_be_blank")},{required:!0,trigger:"change,blur",type:"date",validator:function(t,n,r){n&&n<e.formData.billing.json.from_datetime?r(e.$t("messages.invalid_end_date")):r()}}]}},[n("DatePicker",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("form.billing.placeholder.to"),type:"date",format:"dd/MM/yyyy"},model:{value:e.formData.billing.json.to_datetime,callback:function(t){e.$set(e.formData.billing.json,"to_datetime",t)},expression:"formData.billing.json.to_datetime"}})],1)],1)],1),e._v(" "),"maintenance_fee"===e.billingTypeKey?n("FormItem",{attrs:{prop:"payByAssetTypeValue"}},[n("RadioGroup",{on:{"on-change":e.setPayByAssetType},model:{value:e.formData.payByAssetTypeValue,callback:function(t){e.$set(e.formData,"payByAssetTypeValue",t)},expression:"formData.payByAssetTypeValue"}},[n("Radio",{attrs:{label:e.$t("button.actual")}},[e._v("\n          "+e._s(e.$t("button.actual"))+"\n        ")]),e._v(" "),n("Radio",{attrs:{label:e.$t("button.asset_type")}},[e._v("\n          "+e._s(e.$t("button.asset_type"))+"\n        ")])],1)],1):e._e(),e._v(" "),e.formData.payByAssetType||"maintenance_fee"!==e.billingTypeKey?"water_billing"===e.billingTypeKey||"other_billing"===e.billingTypeKey?n("FormItem",{attrs:{prop:"billing.json.price_per_unit",label:e.$t("form.billing.label.price_per_unit"),rules:[{trigger:"blur,change",required:!0,message:e.$t("form.billing.label.price_per_unit")+e.$t("error.cannot_be_blank")}]}},[n("Input",{attrs:{placeholder:e.$t("form.billing.placeholder.price_per_unit")},model:{value:e.formData.billing.json.price_per_unit,callback:function(t){e.$set(e.formData.billing.json,"price_per_unit",t)},expression:"formData.billing.json.price_per_unit"}})],1):n("div",[n("span",[e._v("\n        "+e._s(e.$t("form.billing.label.price_per_unit"))+"\n      ")]),e._v(" "),e.formData.assetTypes.length>0?n("div",e._l(e.unitTypes,(function(t,r){return n("FormItem",{key:t.id,attrs:{label:t.name,prop:"assetTypes["+r+"].price_per_unit",rules:[{trigger:"blur,change",required:!0,message:e.$t("form.billing.label.price_per_unit")+e.$t("error.cannot_be_blank")}]}},[n("Input",{attrs:{placeholder:e.$t("form.billing.placeholder.price_per_unit")},model:{value:e.formData.assetTypes[r].price_per_unit,callback:function(t){e.$set(e.formData.assetTypes[r],"price_per_unit",t)},expression:"formData.assetTypes[index].price_per_unit"}})],1)})),1):e._e()]):n("FormItem",{attrs:{prop:"billingPricePerUnit",label:e.$t("form.billing.label.price_per_unit"),rules:[{trigger:"blur,change",required:!0,message:e.$t("form.billing.label.price_per_unit")+e.$t("error.cannot_be_blank")}]}},[n("Input",{attrs:{placeholder:e.$t("form.billing.placeholder.price_per_unit")},model:{value:e.formData.billingPricePerUnit,callback:function(t){e.$set(e.formData,"billingPricePerUnit",t)},expression:"formData.billingPricePerUnit"}})],1),e._v(" "),"other_billing"===e.billingTypeKey?n("FormItem",{attrs:{prop:"billing.json.amount",label:e.$t("form.billing.label.unit_used"),rules:[{trigger:"blur,change",required:!0,message:e.$t("form.billing.label.unit_used")+e.$t("error.cannot_be_blank")}]}},[n("Input",{attrs:{placeholder:e.$t("form.billing.placeholder.amount")},model:{value:e.formData.billing.json.amount,callback:function(t){e.$set(e.formData.billing.json,"amount",t)},expression:"formData.billing.json.amount"}})],1):e._e(),e._v(" "),"other_billing"===e.billingTypeKey?n("FormItem",{attrs:{label:e.$t("form.billing.label.amount")}},[n("Input",{attrs:{value:e.convertTotalPrice(),disabled:""}})],1):e._e(),e._v(" "),n("FormItem",{attrs:{align:"center"}},[n("Button",{staticClass:"default-button button-grey",on:{click:function(t){return e.handleClose()}}},[e._v("\n        "+e._s(e.$t("button.cancel"))+"\n      ")]),e._v(" "),n("Button",{staticClass:"default-button button-green",on:{click:function(t){return e.handleSubmit()}}},[e._v("\n        "+e._s(e.$t("button.submit"))+"\n      ")])],1)],2)],1)}),[],!1,null,"3da71a53",null);t.default=component.exports}}]);