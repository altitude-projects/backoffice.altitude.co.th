(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{406:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));r(15),r(18),r(32),r(33);var n=r(4),o=r(7),c=r(30),l=r(31),f=(r(21),r(25),r(3)),j=r(6),h=r(5);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.json=_(_({},t),{},{first_name_translations:t.first_name_translations||{en:"",th:""},last_name_translations:t.last_name_translations||{en:"",th:""},title_translations:t.title_translations||{en:"",th:""}})}var t,r,o,d,m,O,v;return Object(l.a)(e,[{key:"resetPassword",value:(v=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.d)("patch",Object(j.e)(j.b,"reset_password"),{data:{user:this.json},headers:Object(j.c)(!0)});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"forgetPassword",value:(O=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.d)("patch",Object(j.e)(j.b,"forgot_password"),{data:{user:this.json},headers:Object(j.c)(!0)});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"save",value:(m=Object(n.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,(n=Object(h.e)(this.json,"user")).juristic_person="yes"===n.juristic_person,o=Object(h.n)({user:n,addresses:t},null,["profile_image"]),!this.json.id){e.next=10;break}return e.next=7,Object(j.d)("patch",Object(j.e)(j.a,"users/".concat(this.json.id)),{headers:Object(j.c)(!0),data:o});case 7:r=e.sent,e.next=13;break;case 10:return e.next=12,Object(j.d)("post",Object(j.e)(j.a,"users"),{headers:Object(j.c)(!0),data:o});case 12:r=e.sent;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"asInfoJson",value:function(){return{addresses:this.json.addresses,no:this.json.no,customer_code:this.json.customer_code||"-",customer_type:this.json.customer_type||"-",date_of_birth:this.json.date_of_birth?Object(h.g)(this.json.date_of_birth):"-",display_name:this.json.display_name?this.json.display_name:"-",email:this.json.email||"-",facebook:this.json.facebook||"-",full_name:this.fullName(),gender:this.json.gender,id:this.json.id,issue_at:this.json.issue_at||"-",juristic_person:this.json.juristic_person,language:this.json.language||"-",line:this.json.line||"-",marital_status:this.json.marital_status,mobile_primary:this.json.mobile_primary||"-",mobile_secondary:this.json.mobile_secondary||"-",nationality:Object(f.startCase)(this.json.nationality),passport_country:this.json.passport_country||"-",passport_number:this.json.passport_number||"-",profile_image:this.json.profile_image||null,race:Object(f.startCase)(this.json.race),telephone_oversea:this.json.telephone_oversea||"-",telephone:this.json.telephone||"-",thai_id_number:this.json.thai_id_number||"-",user_assets:this.json.user_assets,wechat:this.json.wechat||"-",whatsapp:this.json.whatsapp||"-"}}},{key:"fullName",value:function(){var e=[],t=[];return this.json.first_name_translations&&Object.keys(this.json.first_name_translations).length>0&&(e.push(this.json.first_name_translations.th),t.push(this.json.first_name_translations.en)),this.json.last_name_translations&&Object.keys(this.json.last_name_translations).length>0&&(e.push(this.json.last_name_translations.th),t.push(this.json.last_name_translations.en)),{th:e.join(" "),en:t.join(" ")}}}],[{key:"index",value:(d=Object(n.a)(regeneratorRuntime.mark((function t(r,n,o,c){var l,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(j.d)("get",Object(j.e)(j.a,"projects/".concat(r,"/user_assets")),{params:{page:n,per_page:o,search:c},headers:Object(j.c)(!0)});case 2:if(200!==(l=t.sent).status){t.next=6;break}return h=Object(f.map)(l.data.users,(function(t){return new e(t)})),t.abrupt("return",{users:h,total_count:l.data.total_count});case 6:return t.abrupt("return",[]);case 7:case"end":return t.stop()}}),t)}))),function(e,t,r,n){return d.apply(this,arguments)})},{key:"show",value:(o=Object(n.a)(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(j.d)("get",Object(j.e)(j.a,"users/".concat(r)),{headers:Object(j.c)(!0)});case 2:if(200!==(n=t.sent).status){t.next=5;break}return t.abrupt("return",new e(n.data.user));case 5:case"end":return t.stop()}}),t)}))),function(e){return o.apply(this,arguments)})},{key:"destroy",value:(r=Object(n.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.d)("delete",Object(j.e)(j.a,"users/".concat(t)),{headers:Object(j.c)(!0)});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"importUserAssets",value:(t=Object(n.a)(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",r),e.next=4,Object(j.d)("post",Object(j.e)(j.a,"projects/".concat(t,"/assets/import_user_assets")),{headers:Object(j.c)(!0,!0),data:n});case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})}]),e}()},415:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));r(21),r(15),r(18),r(32),r(33);var n=r(4),o=r(7),c=r(30),l=r(31),f=(r(25),r(3)),j=r(6),h=r(406),d=r(5);function _(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function m(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.json=m(m({},t),{},{asset_label:t.asset_label||"",asset_id:t.asset_id||"",is_billing_owner:t.is_billing_owner||""})}var t,r,o,_,O;return Object(l.a)(e,[{key:"save",value:(O=Object(n.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,"Yes"===(n=Object(f.cloneDeep)(this.json)).is_billing_owner?n.is_billing_owner=!0:n.is_billing_owner=!1,o=Object(d.e)(n,"userAsset"),!n.id){e.next=10;break}return e.next=7,Object(j.d)("patch",Object(j.e)(j.a,"projects/".concat(t,"/user_assets/").concat(n.id)),{headers:Object(j.c)(!0),data:o});case 7:r=e.sent,e.next=13;break;case 10:return e.next=12,Object(j.d)("post",Object(j.e)(j.a,"projects/".concat(t,"/user_assets")),{headers:Object(j.c)(!0),data:o});case 12:r=e.sent;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"user",value:function(){return new h.a(this.json.user)}}],[{key:"roleForSelect",value:(_=Object(n.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.d)("get",Object(j.e)(j.a,"projects/".concat(t,"/user_assets/roles_for_select")),{headers:Object(j.c)(!0)});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",r.data.roles);case 5:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)})},{key:"userAssetForUser",value:(o=Object(n.a)(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.d)("get",Object(j.e)(j.a,"projects/".concat(t,"/user_assets/user_assets_for_user")),{params:{user_id:r},headers:Object(j.c)(!0)});case 2:if(200!==(n=e.sent).status){e.next=6;break}return o=Object(f.map)(n.data.user_assets,(function(e,t){return e.asset.no=t+1,e.asset.role&&(e.asset.role=Object(f.startCase)(e.json.role)),e.asset})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"show",value:(r=Object(n.a)(regeneratorRuntime.mark((function t(r,n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(j.d)("get",Object(j.e)(j.a,"projects/".concat(r,"/user_assets/").concat(n)),{headers:Object(j.c)(!0)});case 2:if(200!==(o=t.sent).status){t.next=5;break}return t.abrupt("return",new e(o.data.user_asset));case 5:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})},{key:"destroy",value:(t=Object(n.a)(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.d)("delete",Object(j.e)(j.a,"projects/".concat(t,"/user_assets/").concat(r)),{headers:Object(j.c)(!0)});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})}]),e}()},564:function(e,t,r){"use strict";r.r(t);var n=r(4),o=(r(11),r(25),r(3)),c=r(415),l={props:{items:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!0}},data:function(){var e=this;return{roles:[],columns:[{slot:"name",width:80,renderHeader:function(t,r){return t("span","".concat(e.$t("info.user.label.name")))}},{slot:"role",width:80,renderHeader:function(t,r){return t("span","".concat(e.$t("info.user.label.resident_type")))}},{slot:"email",width:80,renderHeader:function(t,r){return t("span","".concat(e.$t("info.user.label.email")))}},{slot:"mobile",width:80,align:"center",renderHeader:function(t,r){return t("span","".concat(e.$t("info.user.label.mobile")))}},{slot:"is_billing_owner",width:100,align:"center",renderHeader:function(t,r){return t("span","".concat(e.$t("info.user.label.billing_owner")))}},{slot:"action",width:80,align:"center",renderHeader:function(t,r){return t("span","".concat(e.$t("info.user.label.action")))}}]}},computed:{language:function(){return this.$store.state.language.value}},mounted:function(){this.getRoles()},methods:{getRoles:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.roleForSelect(e.$route.params.projectId);case 2:e.roles=t.sent;case 3:case"end":return t.stop()}}),t)})))()},filterRole:function(data){var e=Object(o.find)(this.roles,["value",data]);return e&&e.label[this.language]||"-"},handleRemove:function(e){var t=this;return new Promise((function(r){t.$Modal.confirm({title:t.$t("pages.confirm"),content:t.$t("messages.confirm_remove"),okText:t.$t("button.yes"),cancelText:t.$t("button.no"),onOk:function(){t.removeUserAsset(e.id)}})}))},convertIsBillingOwner:function(e){return e?this.$t("info.user.billing_owner.label.is_billing_owner"):this.$t("info.user.billing_owner.label.is_not_billing_owner")},convertUserRole:function(e){return"owner"===e?this.$t("info.user.label.role_owner"):"family"===e?this.$t("info.user.label.role_family"):this.$t("info.user.label.role_tenant")},removeUserAsset:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.a.destroy(t.$route.params.projectId,e);case 2:200===(n=r.sent).status?(t.$Message.success({content:t.$t("messages.successfully_remove"),duration:3}),t.$emit("reloadData")):n.data&&n.data.error?t.$Message.error({content:n.data.error,duration:8}):t.$Message.error({content:t.$t("messages.fail"),duration:8}),t.$emit("reloadData");case 5:case"end":return r.stop()}}),r)})))()}}},f=r(9),component=Object(f.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Table",{attrs:{columns:e.columns,data:e.items,loading:e.loading,"no-data-text":e.$t("pages.no_data")},scopedSlots:e._u([{key:"name",fn:function(t){var r=t.row;return[e._v("\n    "+e._s(r.user["full_name_"+e.$store.state.language.value])+"\n  ")]}},{key:"role",fn:function(t){var r=t.row;return[e._v("\n    "+e._s(e.filterRole(r.role))+"\n  ")]}},{key:"email",fn:function(t){var r=t.row;return[e._v("\n    "+e._s(r.user.email||"-")+"\n  ")]}},{key:"mobile",fn:function(t){var r=t.row;return[e._v("\n    "+e._s(r.user.mobile_primary||"-")+"\n  ")]}},{key:"default_language",fn:function(t){var r=t.row;return[e._v("\n    "+e._s(r.user.language||"-")+"\n  ")]}},{key:"is_billing_owner",fn:function(t){var r=t.row;return[e._v("\n    "+e._s(e.convertIsBillingOwner(r.is_billing_owner)||"-")+"\n  ")]}},{key:"action",fn:function(t){var n=t.row;return[r("div",{staticClass:"py-3"},[r("Tooltip",{attrs:{content:e.$t("button.edit"),placement:"top"}},[r("Icon",{staticStyle:{cursor:"pointer"},attrs:{type:"ios-create-outline",size:"20"},on:{click:function(t){return e.$emit("extraFunctionWithObject",n)}}})],1),e._v(" "),r("Tooltip",{attrs:{content:e.$t("button.remove"),placement:"top"}},[r("Icon",{staticStyle:{cursor:"pointer"},attrs:{type:"ios-trash-outline",size:"20"},on:{click:function(t){return e.handleRemove(n)}}})],1)],1)]}}])})}),[],!1,null,"75202da2",null);t.default=component.exports}}]);