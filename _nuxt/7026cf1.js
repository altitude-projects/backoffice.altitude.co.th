(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{414:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(4),c=n(30),o=n(31),d=(n(25),n(3)),l=n(6),f=n(5),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,t),this.json=e,this.json.name_translations=e.name_translations||{en:"",th:""}}var e,n,h,m,y;return Object(o.a)(t,[{key:"save",value:(y=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,c=Object(f.e)(this.json,"incidentTypes"),c=Object(f.n)(c,"incident_type"),!n){t.next=10;break}return t.next=6,Object(l.d)("patch",Object(l.e)(l.a,"projects/".concat(e,"/incident_types/").concat(n)),{data:c,headers:Object(l.c)(!0)});case 6:return r=t.sent,t.abrupt("return",r);case 10:return t.next=12,Object(l.d)("post",Object(l.e)(l.a,"projects/".concat(e,"/incident_types")),{data:c,headers:Object(l.c)(!0)});case 12:return r=t.sent,t.abrupt("return",r);case 14:case"end":return t.stop()}}),t,this)}))),function(t,e){return y.apply(this,arguments)})},{key:"activate",value:(m=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(l.d)("patch",Object(l.e)(l.a,"projects/".concat(e,"/incident_types/").concat(n,"/activate")),{headers:Object(l.c)(!0)});case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)}))),function(t,e){return m.apply(this,arguments)})},{key:"inactivate",value:(h=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(l.d)("patch",Object(l.e)(l.a,"projects/".concat(e,"/incident_types/").concat(n,"/inactivate")),{headers:Object(l.c)(!0)});case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)}))),function(t,e){return h.apply(this,arguments)})},{key:"asTableJson",value:function(){return{no:this.json.no,created_at:this.json.created_at,id:this.json.id,key:this.json.key,name_translations:this.json.name_translations,sorting_index:this.json.sorting_index?parseFloat(this.json.sorting_index).toFixed(1):"-",status:this.json.status}}}],[{key:"index",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.d)("get",Object(l.e)(l.a,"projects/".concat(n,"/incident_types")),{headers:Object(l.c)(!0)});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",Object(d.map)(r.data.incident_types,(function(e){return new t(e)})));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)}))),function(t){return n.apply(this,arguments)})},{key:"show",value:(e=Object(r.a)(regeneratorRuntime.mark((function e(n,r){var c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.d)("get",Object(l.e)(l.a,"projects/".concat(n,"/incident_types/").concat(r)),{headers:Object(l.c)(!0)});case 2:if(200!==(c=e.sent).status){e.next=5;break}return e.abrupt("return",new t(c.data.incident_type));case 5:return e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)}))),function(t,n){return e.apply(this,arguments)})}]),t}()},554:function(t,e,n){"use strict";n.r(e);var r=n(4),c=(n(11),n(25),n(414)),o={props:{items:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!0}},data:function(){var t=this;return{editImage:"",columns:[{title:"No.",key:"no",align:"center",width:80,renderHeader:function(e,n){return e("span","".concat(t.$t("info.incident_type.label.no")))}},{title:"Key",key:"key",slot:"key",width:160,sortable:"custom",renderHeader:function(e,n){return e("span","".concat(t.$t("info.incident_type.label.key")))}},{title:"Name(TH)",key:"name_translations.th",slot:"name_th",width:180,sortable:"custom",renderHeader:function(e,n){return e("span","".concat(t.$t("info.incident_type.label.name_th")))}},{title:"Name(EN)",key:"name_translations.en",slot:"name_en",width:180,sortable:"custom",renderHeader:function(e,n){return e("span","".concat(t.$t("info.incident_type.label.name_en")))}},{title:"Sorting Index",key:"sorting_index",align:"center",width:130,sortable:"custom",renderHeader:function(e,n){return e("span","".concat(t.$t("info.incident_type.label.sorting_index")))}},{title:"Status",key:"status",slot:"status",align:"center",width:160,sortable:"custom",renderHeader:function(e,n){return e("span","".concat(t.$t("info.incident_type.label.status")))}},{title:"Action",slot:"action",align:"center",width:160,renderHeader:function(e,n){return e("span","".concat(t.$t("info.incident_type.label.action")))}}]}},methods:{handleSortChange:function(t){this.$emit("sortBy",t.key,t.order)},changeStatus:function(data){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new c.a(data),"active"!==data.status){e.next=7;break}return e.next=4,r.inactivate(t.$route.params.projectId,data.id);case 4:n=e.sent,e.next=10;break;case 7:return e.next=9,r.activate(t.$route.params.projectId,data.id);case 9:n=e.sent;case 10:n&&200===n.status?t.$Message.success({content:t.$t("messages.successfully_".concat(n.data.incident_type.status)),duration:3}):n.data&&n.data.error?t.$Message.error({content:n.data.error,duration:8}):t.$Message.error({content:t.$t("messages.fail"),duration:8}),t.$emit("reloadData");case 12:case"end":return e.stop()}}),e)})))()},handleBeforeChange:function(){var t=this;return new Promise((function(e){t.$Modal.confirm({title:t.$t("pages.confirm"),content:t.$t("messages.confirm_change_status"),okText:t.$t("button.ok"),cancelText:t.$t("button.cancel"),onOk:function(){e()}})}))},statusSetting:function(t){return"active"===t}}},d=n(9),component=Object(d.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Table",{attrs:{columns:t.columns,data:t.items,loading:t.loading,"no-data-text":t.$t("pages.no_data")},on:{"on-sort-change":t.handleSortChange},scopedSlots:t._u([{key:"key",fn:function(e){var r=e.row;return[n("nuxt-link",{attrs:{to:{name:"projects-projectId-incident_types-incidentTypeId-show",params:{incidentTypeId:r.id}}}},[n("Row",{attrs:{type:"flex"}},[n("Col",[n("span",[t._v("\n              "+t._s(r.key)+"\n            ")])])],1)],1)]}},{key:"name_th",fn:function(e){var r=e.row;return[n("span",[t._v("\n        "+t._s(r.name_translations?r.name_translations.th:"-")+"\n      ")])]}},{key:"name_en",fn:function(e){var r=e.row;return[n("span",[t._v("\n        "+t._s(r.name_translations?r.name_translations.en:"-")+"\n      ")])]}},{key:"status",fn:function(e){var r=e.row;return[n("i-switch",{attrs:{value:t.statusSetting(r.status),"before-change":t.handleBeforeChange,"true-color":"#57BA5B","false-color":"#F3F3F3",size:"small"},on:{"on-change":function(e){return t.changeStatus(r)}}})]}},{key:"action",fn:function(t){var e=t.row;return[n("nuxt-link",{attrs:{to:{name:"projects-projectId-incident_types-incidentTypeId-edit",params:{incidentTypeId:e.id}}}},[n("Row",{attrs:{type:"flex",justify:"center"}},[n("Col",{attrs:{span:"4"}},[n("Icon",{staticStyle:{cursor:"pointer"},attrs:{size:"20",color:"#5c6b77",type:"ios-create-outline"}})],1)],1)],1)]}}])})],1)}),[],!1,null,"52b0e798",null);e.default=component.exports}}]);