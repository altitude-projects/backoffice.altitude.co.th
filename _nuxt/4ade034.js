(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{414:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(4),o=n(30),c=n(31),l=(n(25),n(3)),d=n(6),m=n(5),f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,t),this.json=e,this.json.name_translations=e.name_translations||{en:"",th:""}}var e,n,f,h,_;return Object(c.a)(t,[{key:"save",value:(_=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,o=Object(m.e)(this.json,"incidentTypes"),o=Object(m.n)(o,"incident_type"),!n){t.next=10;break}return t.next=6,Object(d.d)("patch",Object(d.e)(d.a,"projects/".concat(e,"/incident_types/").concat(n)),{data:o,headers:Object(d.c)(!0)});case 6:return r=t.sent,t.abrupt("return",r);case 10:return t.next=12,Object(d.d)("post",Object(d.e)(d.a,"projects/".concat(e,"/incident_types")),{data:o,headers:Object(d.c)(!0)});case 12:return r=t.sent,t.abrupt("return",r);case 14:case"end":return t.stop()}}),t,this)}))),function(t,e){return _.apply(this,arguments)})},{key:"activate",value:(h=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.d)("patch",Object(d.e)(d.a,"projects/".concat(e,"/incident_types/").concat(n,"/activate")),{headers:Object(d.c)(!0)});case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)}))),function(t,e){return h.apply(this,arguments)})},{key:"inactivate",value:(f=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.d)("patch",Object(d.e)(d.a,"projects/".concat(e,"/incident_types/").concat(n,"/inactivate")),{headers:Object(d.c)(!0)});case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)}))),function(t,e){return f.apply(this,arguments)})},{key:"asTableJson",value:function(){return{no:this.json.no,created_at:this.json.created_at,id:this.json.id,key:this.json.key,name_translations:this.json.name_translations,sorting_index:this.json.sorting_index?parseFloat(this.json.sorting_index).toFixed(1):"-",status:this.json.status}}}],[{key:"index",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("get",Object(d.e)(d.a,"projects/".concat(n,"/incident_types")),{headers:Object(d.c)(!0)});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",Object(l.map)(r.data.incident_types,(function(e){return new t(e)})));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)}))),function(t){return n.apply(this,arguments)})},{key:"show",value:(e=Object(r.a)(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)("get",Object(d.e)(d.a,"projects/".concat(n,"/incident_types/").concat(r)),{headers:Object(d.c)(!0)});case 2:if(200!==(o=e.sent).status){e.next=5;break}return e.abrupt("return",new t(o.data.incident_type));case 5:return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),function(t,n){return e.apply(this,arguments)})}]),t}()},793:function(t,e,n){"use strict";n.r(e);n(21),n(15),n(18),n(32),n(33);var r=n(7),o=n(4),c=(n(11),n(25),n(3)),l=n(414);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function m(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var f={props:{isNew:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},defaultData:{type:Object,default:function(){return{}}},type:{type:String,default:function(){return"new"}}},data:function(){return{formData:new l.a,incidentTypeInfo:{},isLoading:!this.isNew,title:{},rules:{key:[{required:!0,message:this.$t("form.incident_type.label.key")+" "+this.$t("error.cannot_be_blank"),trigger:"blur,change"}],"name_translations.th":[{required:!0,message:this.$t("form.incident_type.label.name_th")+" "+this.$t("error.cannot_be_blank"),trigger:"blur,change"}],"name_translations.en":[{required:!0,message:this.$t("form.incident_type.label.name_en")+" "+this.$t("error.cannot_be_blank"),trigger:"blur,change"}]}}},computed:{language:function(){return this.$store.state.language.value}},watch:{"formData.key":function(t){this.formData.key=Object(c.toLower)(Object(c.replace)(t," ","_"))},language:function(){this.rules.key[0].message=this.$t("form.incident_type.label.key")+" "+this.$t("error.cannot_be_blank"),this.rules["name_translations.th"][0].message=this.$t("form.incident_type.label.name_th")+" "+this.$t("error.cannot_be_blank"),this.rules["name_translations.en"][0].message=this.$t("form.incident_type.label.name_en")+" "+this.$t("error.cannot_be_blank"),this.$store.state.isSelectLanguage&&this.$nextTick((function(){this.$refs.form&&this.$refs.form.validate()}))}},mounted:function(){this.isNew||this.fetchIncidentInfo()},methods:{fetchIncidentInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,l.a.show(t.$route.params.projectId,t.$route.params.incidentTypeId);case 3:n=e.sent,t.formData=n,t.title=m({},t.formData.json.name_translations),t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},handleSubmit:function(){var t=this;return new Promise((function(e){t.$Modal.confirm({title:t.$t("messages.confirm_save"),okText:t.$t("button.yes"),cancelText:t.$t("button.no"),onOk:function(){t.submitForm()}})}))},submitForm:function(){var t=this;this.$refs.form.validate(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n,r){var o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}return t.isLoading=!0,e.next=4,t.formData.save(t.$route.params.projectId,t.$route.params.incidentTypeId);case 4:(o=e.sent).data&&o.data.success?(t.$Message.success({content:"".concat(t.$t("messages.success")),duration:3}),t.$router.push({name:"projects-projectId-incident_types"})):o.data.error?(l=Object(c.snakeCase)(o.data.error),t.$Message.error({content:t.$t("messages.".concat(l)),duration:8})):t.$Message.error({content:t.$t("messages.fail"),duration:8});case 6:t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}},h=n(9),component=Object(h.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isLoading?n("GLoading"):n("div",[n("GBreadCrumb",{attrs:{names:[t.title]}}),t._v(" "),n("Card",{attrs:{bordered:!1,"dis-hover":"",padding:20}},[n("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.isNew?t.$t("button.new"):t.$t("button.edit"))+t._s(t.$t("pages.incident_type"))+"\n    ")]),t._v(" "),n("Card",{attrs:{bordered:!1,"dis-hover":""}},[n("Row",{attrs:{type:"flex",justify:"center"}},[n("Col",{attrs:{xs:24,sm:12}},[n("Form",{ref:"form",attrs:{rules:t.rules,model:t.formData.json,"label-position":"top"}},[n("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"key",label:t.$t("form.incident_type.label.key")}},[n("Input",{attrs:{placeholder:t.$t("form.incident_type.placeholder.key")},model:{value:t.formData.json.key,callback:function(e){t.$set(t.formData.json,"key",e)},expression:"formData.json.key"}})],1),t._v(" "),n("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"name_translations.th",label:t.$t("form.incident_type.label.name_th")}},[n("Input",{attrs:{placeholder:t.$t("form.incident_type.placeholder.name_th")},model:{value:t.formData.json.name_translations.th,callback:function(e){t.$set(t.formData.json.name_translations,"th",e)},expression:"formData.json.name_translations.th"}})],1),t._v(" "),n("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"name_translations.en",label:t.$t("form.incident_type.label.name_en")}},[n("Input",{attrs:{placeholder:t.$t("form.incident_type.placeholder.name_en")},model:{value:t.formData.json.name_translations.en,callback:function(e){t.$set(t.formData.json.name_translations,"en",e)},expression:"formData.json.name_translations.en"}})],1),t._v(" "),n("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"sorting_index",label:t.$t("form.incident_type.label.sorting_index")}},[n("Input",{attrs:{placeholder:t.$t("form.incident_type.placeholder.sorting_index")},model:{value:t.formData.json.sorting_index,callback:function(e){t.$set(t.formData.json,"sorting_index",e)},expression:"formData.json.sorting_index"}})],1),t._v(" "),n("FormItem",{staticClass:"font-weight-bold text-center"},[n("Button",{staticClass:"default-button button-grey",attrs:{to:t.isEdit?{name:"projects-projectId-incident_types-incidentTypeId-show"}:{name:"projects-projectId-incident_types"}}},[t._v("\n                "+t._s(t.$t("button.cancel"))+"\n              ")]),t._v(" "),n("Button",{staticClass:"default-button",attrs:{type:"success"},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("\n                "+t._s(t.$t("button.save"))+"\n              ")])],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,"5131d8c4",null);e.default=component.exports}}]);