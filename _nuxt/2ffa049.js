(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{424:function(t,e,r){"use strict";r.d(e,"a",(function(){return v}));var n=r(4),o=r(30),c=r(31),l=(r(25),r(3)),f=r(6),d=r(5),v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,t),this.json=e,this.json.value=e.value||[]}var e,r,v;return Object(c.a)(t,[{key:"save",value:(v=Object(n.a)(regeneratorRuntime.mark((function t(e){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,n=Object(d.e)(this.json,"configuration"),n=Object(d.n)(n,"configuration"),!this.json.id){t.next=9;break}return t.next=6,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(e,"/configurations/").concat(this.json.id)),{data:n,headers:Object(f.c)(!0)});case 6:r=t.sent,t.next=12;break;case 9:return t.next=11,Object(f.d)("post",Object(f.e)(f.a,"projects/".concat(e,"/configurations")),{data:n,headers:Object(f.c)(!0)});case 11:r=t.sent;case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"asTableJson",value:function(){return{id:this.json.id,key:this.json.key,value:this.json.value}}}],[{key:"index",value:(r=Object(n.a)(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(r,"/configurations")),{headers:Object(f.c)(!0)});case 2:if(200!==(n=e.sent).status){e.next=5;break}return e.abrupt("return",Object(l.map)(n.data.configurations,(function(e){return new t(e)})));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)}))),function(t){return r.apply(this,arguments)})},{key:"show",value:(e=Object(n.a)(regeneratorRuntime.mark((function e(r,n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(r,"/configurations/").concat(n)),{headers:Object(f.c)(!0)});case 2:if(200!==(o=e.sent).status){e.next=5;break}return e.abrupt("return",new t(o.data.configuration));case 5:return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),function(t,r){return e.apply(this,arguments)})}]),t}()},516:function(t,e,r){var content=r(636);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(23).default)("30cf7b70",content,!0,{sourceMap:!1})},635:function(t,e,r){"use strict";r(516)},636:function(t,e,r){var n=r(22)(!1);n.push([t.i,".btn-add[data-v-25a175e1]{background-color:#fff;border:1px solid #d5d5d5;color:#70706e}@media screen and (max-width:600px){.row-button-add[data-v-25a175e1]{justify-content:center}}",""]),t.exports=n},781:function(t,e,r){"use strict";r.r(e);var n=r(7),o=r(4),c=(r(11),r(21),r(15),r(18),r(32),r(33),r(25),r(3)),l=r(424);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v={props:{isNew:{type:Boolean,default:!1},defaultData:{type:Object,default:function(){return{}}},type:{type:String,default:function(){return"new"}}},data:function(){return{formData:new l.a,isLoading:!this.isNew,rules:{key:[{required:!0,message:this.$t("form.configuration.label.key")+" "+this.$t("error.cannot_be_blank"),trigger:"blur,change"}]}}},computed:{backUrl:function(){return{name:"projects-projectId-configurations"}},language:function(){return this.$store.state.language.value}},watch:{"formData.key":function(t){this.formData.key=Object(c.toLower)(Object(c.replace)(t," ","_"))},language:function(){this.rules.key[0].message=this.$t("form.configuration.label.key")+" "+this.$t("error.cannot_be_blank"),this.$store.state.isSelectLanguage&&this.$nextTick((function(){this.$refs.form&&this.$refs.form.validate()}))}},mounted:function(){this.isNew||this.fetchConfiguration()},methods:{checkDefaultKey:function(t){return!!t&&Object(c.includes)(["billing_info","company_name","billing_address","incident_email","telephone","building","floor","tin","resident_address"],t)},fetchConfiguration:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,l.a.show(t.$route.params.projectId,t.$route.params.configurationId);case 3:r=e.sent,t.formData=r,Object(c.includes)(["floor","building"],t.formData.json.value[0].key)&&!t.formData.json.value[0].value&&(t.formData.json.value[0].value=[""]),t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},removeArray:function(t){this.formData.json.value.splice(t,1)},removeValue:function(t,e){1===this.formData.json.value[t].value.length?this.removeArray(t):this.formData.json.value[t].value.splice(e,1)},valueIsArray:function(t){return Object(c.isArray)(this.formData.json.value[t].value)},addTo:function(text){"text"===text?this.formData.json.value.push({key:"",value:""}):this.formData.json.value.push({key:"",value:[""]})},addValue:function(t){this.formData.json.value[t].value.push("")},handleSubmit:function(){var t=this;return new Promise((function(e){t.$Modal.confirm({title:t.$t("messages.confirm_save"),okText:t.$t("button.yes"),cancelText:t.$t("button.no"),onOk:function(){t.submitForm()}})}))},updateFormData:function(t){this.formData.json=d(d({},this.formData.json),t)},submitForm:function(){var t=this;if(this.formData.json.value.length<1)return this.$Message.error({content:this.$t("error.please_select_add_text_or_array"),duration:8}),!1;this.$refs.form.validate(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(r,n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return t.isLoading=!0,e.next=4,t.formData.save(t.$route.params.projectId);case 4:(o=e.sent).data&&o.data.success?(t.$Message.success({content:"".concat(t.$t("messages.success")),duration:3}),t.$router.push({name:"projects-projectId-configurations",params:{projectId:t.$route.params.projectId}})):o.data.error?t.$Message.error({content:o.data.error,duration:8}):t.$Message.error({content:t.$t("messages.fail")});case 6:t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}}},m=(r(635),r(9)),component=Object(m.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.isLoading?r("GLoading"):r("div",[r("GBreadCrumb",{attrs:{names:[t.formData.json.key],"is-not-show":""}}),t._v(" "),r("Card",{attrs:{bordered:!1,"dis-hover":"",padding:20}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.isNew?t.$t("button.new"):t.$t("button.edit"))+t._s(t.$t("pages.configuration"))+"\n    ")]),t._v(" "),r("Card",{staticClass:"mt-20",attrs:{bordered:!1,"dis-hover":""}},[r("Row",{attrs:{type:"flex",justify:"center"}},[r("Col",{attrs:{xs:18}},[r("Form",{ref:"form",attrs:{rules:t.rules,model:t.formData.json,"label-position":"top"}},[r("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"key",label:t.$t("form.configuration.label.key_name")}},[r("Input",{attrs:{disabled:t.checkDefaultKey(t.formData.json.key)},model:{value:t.formData.json.key,callback:function(e){t.$set(t.formData.json,"key",e)},expression:"formData.json.key"}})],1),t._v(" "),r("Divider"),t._v(" "),t._l(t.formData.json.value,(function(e,n){return r("div",{key:n},[r("Row",{attrs:{type:"flex",justify:"end",gutter:24}},[r("Col",{attrs:{span:10}},[r("FormItem",{staticClass:"font-weight-bold",attrs:{label:t.$t("form.configuration.label.key"),prop:"value["+n+"].key"}},[r("Row",{attrs:{type:"flex"}},[r("Col",{attrs:{span:20}},[r("Input",{attrs:{disabled:t.checkDefaultKey(t.formData.json.value[n].key)},model:{value:t.formData.json.value[n].key,callback:function(e){t.$set(t.formData.json.value[n],"key",e)},expression:"formData.json.value[index].key"}})],1),t._v(" "),r("Col",[t.checkDefaultKey(t.formData.json.value[n].key)?t._e():r("Icon",{staticStyle:{cursor:"pointer"},attrs:{size:"24",type:"md-close"},on:{click:function(e){return t.removeArray(n)}}})],1)],1)],1)],1),t._v(" "),r("Col",{attrs:{span:14}},[t.valueIsArray(n)?r("div",t._l(t.formData.json.value[n].value,(function(e,i){return r("div",{key:i},[r("FormItem",{staticClass:"font-weight-bold",attrs:{label:t.$t("form.configuration.label.value"),prop:"value["+n+"].value["+i+"]"}},[r("Row",{attrs:{type:"flex"}},[r("Col",{attrs:{span:20}},[r("Input",{model:{value:t.formData.json.value[n].value[i],callback:function(e){t.$set(t.formData.json.value[n].value,i,e)},expression:"formData.json.value[index].value[i]"}})],1),t._v(" "),r("Col",[t.formData.json.value[n].value.length>1?r("Icon",{staticStyle:{cursor:"pointer"},attrs:{size:"24",type:"md-close"},on:{click:function(e){return t.removeValue(n,i)}}}):t._e()],1)],1)],1)],1)})),0):r("div",[r("FormItem",{staticClass:"font-weight-bold",attrs:{label:t.$t("form.configuration.label.value"),prop:"value["+n+"].value"}},[r("Row",{attrs:{type:"flex"}},[r("Col",{attrs:{span:20}},[r("Input",{model:{value:t.formData.json.value[n].value,callback:function(e){t.$set(t.formData.json.value[n],"value",e)},expression:"formData.json.value[index].value"}})],1),t._v(" "),r("Col",[t.checkDefaultKey(t.formData.json.value[n].key)?t._e():r("Icon",{staticStyle:{cursor:"pointer"},attrs:{size:"24",type:"md-close"},on:{click:function(e){return t.removeArray(n)}}})],1)],1)],1)],1)])],1),t._v(" "),r("Row",{attrs:{type:"flex",gutter:24}},[r("Col",{attrs:{offset:10}},[t.valueIsArray(n)?r("Button",{staticClass:"btn-add",attrs:{ghost:""},on:{click:function(e){return t.addValue(n)}}},[t._v("\n                    "+t._s(t.$t("button.add_value"))+"\n                  ")]):t._e()],1)],1),t._v(" "),r("Divider")],1)})),t._v(" "),r("Row",{staticClass:"row-button-add",attrs:{type:"flex",justify:"end",gutter:20}},[r("Col",[r("Button",{staticClass:"btn-add mt-10",attrs:{ghost:""},on:{click:function(e){return t.addTo("text")}}},[t._v("\n                  "+t._s(t.$t("button.add_text"))+"\n                ")])],1),t._v(" "),r("Col",[r("Button",{staticClass:"btn-add mt-10",attrs:{ghost:""},on:{click:function(e){return t.addTo("array")}}},[t._v("\n                  "+t._s(t.$t("button.add_array"))+"\n                ")])],1)],1),t._v(" "),r("Row",{staticClass:"mt-10",attrs:{type:"flex",justify:"center"}},[r("Button",{staticClass:"default-button button-grey mt-10",attrs:{to:t.backUrl}},[t._v("\n                "+t._s(t.$t("button.cancel"))+"\n              ")]),t._v(" "),r("Button",{staticClass:"default-button mt-10",attrs:{type:"success"},nativeOn:{click:function(e){return t.handleSubmit(e)}}},[t._v("\n                "+t._s(t.$t("button.save"))+"\n              ")])],1)],2)],1)],1)],1)],1)],1)}),[],!1,null,"25a175e1",null);e.default=component.exports}}]);