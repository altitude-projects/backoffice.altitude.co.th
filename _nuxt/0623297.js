(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{425:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));n(21),n(15),n(18),n(32),n(33);var r=n(4),o=n(7),c=n(30),l=n(31),m=(n(25),n(3)),f=n(6),h=n(5);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function j(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,t),this.json=j(j({},e),{},{name_translations:e.name_translations||{en:"",th:""}})}var e,n,o,d,v;return Object(l.a)(t,[{key:"save",value:(v=Object(r.a)(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,r=Object(h.e)(this.json,"contact"),!this.json.id){t.next=8;break}return t.next=5,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(e,"/contacts/").concat(this.json.id)),{headers:Object(f.c)(!0),data:r});case 5:n=t.sent,t.next=11;break;case 8:return t.next=10,Object(f.d)("post",Object(f.e)(f.a,"projects/".concat(e,"/contacts")),{headers:Object(f.c)(!0),data:r});case 10:n=t.sent;case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"activate",value:(d=Object(r.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(e,"/contacts/").concat(this.json.id,"/activate")),{headers:Object(f.c)(!0)});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"inactivate",value:(o=Object(r.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.d)("patch",Object(f.e)(f.a,"projects/".concat(e,"/contacts/").concat(this.json.id,"/inactivate")),{headers:Object(f.c)(!0)});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"asJson",value:function(){return{id:this.json.id,no:this.json.no,name_en:this.json.name_translations?this.json.name_translations.en:"-",name_th:this.json.name_translations?this.json.name_translations.th:"-",email:this.json.email||"-",telephone:this.json.telephone||"-",status:this.json.status}}}],[{key:"index",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(n,r,o,c){var l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(n,"/contacts")),{params:{page:r,per_page:o,search:c},headers:Object(f.c)(!0)});case 2:if(200!==(l=e.sent).status){e.next=6;break}return h=Object(m.map)(l.data.contacts,(function(e){return new t(e)})),e.abrupt("return",{contacts:h,total_count:l.data.total_count});case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}}),e)}))),function(t,e,r,o){return n.apply(this,arguments)})},{key:"show",value:(e=Object(r.a)(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.d)("get",Object(f.e)(f.a,"projects/".concat(n,"/contacts/").concat(r)),{headers:Object(f.c)(!0)});case 2:if(200!==(o=e.sent).status){e.next=5;break}return e.abrupt("return",new t(o.data.contact));case 5:return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),function(t,n){return e.apply(this,arguments)})}]),t}()},782:function(t,e,n){"use strict";n.r(e);var r=n(4),o=(n(11),n(25),n(425)),c={props:{isNew:{type:Boolean,default:!1}},data:function(){return{formData:new o.a}},computed:{language:function(){return this.$store.state.language.value}},watch:{language:function(){this.$store.state.isSelectLanguage&&this.$nextTick((function(){this.$refs.form&&this.$refs.form.validate()}))}},mounted:function(){this.isNew||this.fetchContact()},methods:{fetchContact:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,o.a.show(t.$route.params.projectId,t.$route.params.contactId);case 3:t.formData=e.sent,t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},handleSubmit:function(){var t=this;return new Promise((function(e){t.$Modal.confirm({title:t.$t("messages.confirm"),content:t.$t("messages.confirm_save"),okText:t.$t("button.yes"),cancelText:t.$t("button.no"),onOk:function(){t.submitForm()}})}))},submitForm:function(){var t=this;this.$refs.form.validate(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,t.formData.save(t.$route.params.projectId);case 3:(r=e.sent).data&&r.data.success?t.isNew?(t.$Message.success({content:t.$t("pages.contact")+t.$t("messages.successfully_created"),duration:3}),t.$router.push({name:"projects-projectId-contacts",params:{projectId:t.$route.params.projectId}})):(t.$Message.success({content:t.$t("pages.contact")+t.$t("messages.successfully_updated"),duration:3}),t.$router.push({name:"projects-projectId-contacts",params:{projectId:t.$route.params.projectId}})):t.$Message.error({content:t.$t("messages.fail"),duration:8});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},l=n(9),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Card",{attrs:{"dis-hover":"",bordered:!1}},[n("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.isNew?t.$t("button.new"):t.$t("button.edit"))+t._s(t.$t("pages.contact"))+"\n    ")]),t._v(" "),n("Card",{attrs:{"dis-hover":"",bordered:!1}},[n("Row",{attrs:{type:"flex",justify:"center"}},[n("Col",{attrs:{xs:24,sm:13}},[n("Form",{ref:"form",attrs:{model:t.formData.json}},[n("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"name_translations.en",label:t.$t("form.contact.label.name_en"),rules:[{required:!0,trigger:"blur,change",validator:function(e,n,r){n?r():r(t.$t("form.contact.label.name_en")+" "+t.$t("error.cannot_be_blank"))}}]}},[n("Input",{attrs:{maxlength:"200","show-word-limit":"",placeholder:t.$t("form.contact.placeholder.name_en")},model:{value:t.formData.json.name_translations.en,callback:function(e){t.$set(t.formData.json.name_translations,"en",e)},expression:"formData.json.name_translations.en"}})],1),t._v(" "),n("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"name_translations.th",label:t.$t("form.contact.label.name_th"),rules:[{required:!0,trigger:"blur,change",validator:function(e,n,r){n?r():r(t.$t("form.contact.label.name_th")+" "+t.$t("error.cannot_be_blank"))}}]}},[n("Input",{attrs:{maxlength:"200","show-word-limit":"",placeholder:t.$t("form.contact.placeholder.name_th")},model:{value:t.formData.json.name_translations.th,callback:function(e){t.$set(t.formData.json.name_translations,"th",e)},expression:"formData.json.name_translations.th"}})],1),t._v(" "),n("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"email",label:t.$t("form.contact.label.email")}},[n("Input",{attrs:{type:"text",placeholder:t.$t("form.contact.placeholder.email")},model:{value:t.formData.json.email,callback:function(e){t.$set(t.formData.json,"email",e)},expression:"formData.json.email"}})],1),t._v(" "),n("FormItem",{staticClass:"font-weight-bold",attrs:{prop:"telephone",label:t.$t("form.contact.label.telephone")}},[n("Input",{attrs:{type:"text",placeholder:t.$t("form.contact.placeholder.telephone")},model:{value:t.formData.json.telephone,callback:function(e){t.$set(t.formData.json,"telephone",e)},expression:"formData.json.telephone"}})],1),t._v(" "),n("FormItem",{attrs:{align:"center"}},[n("Button",{staticClass:"default-button button-grey",attrs:{to:{name:"projects-projectId-contacts",params:{projectId:t.$route.params.projectId}}}},[t._v("\n                "+t._s(t.$t("button.cancel"))+"\n              ")]),t._v(" "),n("Button",{staticClass:"default-button button-green",on:{click:function(e){return t.handleSubmit()}}},[t._v("\n                "+t._s(t.$t("button.save"))+"\n              ")])],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,"41b4e48e",null);e.default=component.exports}}]);