(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{422:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(4),c=n(30),o=n(31),l=(n(25),n(3)),d=n(1),f=n.n(d),h=n(6),m=n(5),j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.json=t}var t,n,d,j,v,_,w;return Object(o.a)(e,[{key:"save",value:(w=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,r=Object(m.e)(this.json,"blog"),!this.json.id){e.next=8;break}return e.next=5,Object(h.d)("patch",Object(h.e)(h.a,"projects/".concat(t,"/blogs/").concat(this.json.id)),{data:r,headers:Object(h.c)(!0)});case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,Object(h.d)("post",Object(h.e)(h.a,"projects/".concat(t,"/blogs")),{data:r,headers:Object(h.c)(!0)});case 10:n=e.sent;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"hideComment",value:(_=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.d)("patch",Object(h.e)(h.a,"projects/".concat(t,"/blogs/").concat(n,"/comments/").concat(r,"/hide_comment")),{headers:Object(h.c)(!0)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return _.apply(this,arguments)})},{key:"unhideComment",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.d)("patch",Object(h.e)(h.a,"projects/".concat(t,"/blogs/").concat(n,"/comments/").concat(r,"/unhide_comment")),{headers:Object(h.c)(!0)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"activate",value:(j=Object(r.a)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.d)("patch",Object(h.e)(h.a,"projects/".concat(t,"/blogs/").concat(n,"/activate")),{headers:Object(h.c)(!0)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return j.apply(this,arguments)})},{key:"inactivate",value:(d=Object(r.a)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.d)("patch",Object(h.e)(h.a,"projects/".concat(t,"/blogs/").concat(n,"/inactivate")),{headers:Object(h.c)(!0)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)})},{key:"asTableJson",value:function(){return{id:this.json.id,running_number:this.json.running_number,no:this.json.no,owner:{full_name_en:this.json.user?this.json.user.full_name_en:"-",full_name_th:this.json.user?this.json.user.full_name_th:"-"},created_at:Object(m.h)(this.json.created_at),title:this.json.title,tag_name_translations:this.json.tag_name_translations,status:this.json.status}}}],[{key:"index",value:(n=Object(r.a)(regeneratorRuntime.mark((function t(n,r,c,o,d,m){var j,v,_;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j="",m&&(j=f()(m).unix()),t.next=4,Object(h.d)("get",Object(h.e)(h.a,"projects/".concat(n,"/blogs")),{headers:Object(h.c)(!0),params:{status:r,page:c,per_page:o,search:d,query_date:j}});case 4:if(200!==(v=t.sent).status){t.next=8;break}return _=Object(l.map)(v.data.blogs,(function(t,n){return t.no=n+1,new e(t)})),t.abrupt("return",{blogs:_,total_count:v.data.total_count});case 8:return t.abrupt("return",[]);case 9:case"end":return t.stop()}}),t)}))),function(e,t,r,c,o,l){return n.apply(this,arguments)})},{key:"show",value:(t=Object(r.a)(regeneratorRuntime.mark((function t(n,r){var c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.d)("get",Object(h.e)(h.a,"projects/".concat(n,"/blogs/").concat(r)),{headers:Object(h.c)(!0)});case 2:if(200!==(c=t.sent).status){t.next=5;break}return t.abrupt("return",new e(c.data.blog));case 5:return t.abrupt("return",c);case 6:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)})}]),e}()},570:function(e,t,n){"use strict";n.r(t);var r=n(4),c=(n(25),n(48),n(11),n(422)),o={props:{items:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!0}},data:function(){var e=this;return{columns:[{slot:"running_number",width:80,renderHeader:function(t,n){return t("span","".concat(e.$t("info.blog.label.id")))},align:"center"},{key:"title",width:120,renderHeader:function(t,n){return t("span","".concat(e.$t("info.blog.label.title")))},align:"center"},{slot:"category",width:120,renderHeader:function(t,n){return t("span","".concat(e.$t("info.blog.label.category")))},align:"center"},{slot:"owner",width:120,renderHeader:function(t,n){return t("span","".concat(e.$t("info.blog.label.owner")))},align:"center"},{key:"created_at",align:"center",width:140,renderHeader:function(t,n){return t("span","".concat(e.$t("info.blog.label.created_at")))}},{slot:"status",align:"center",width:100,renderHeader:function(t,n){return t("span","".concat(e.$t("info.blog.label.status")))}}]}},methods:{getTagName:function(e){var t=this;return e.map((function(e){return e[t.$store.state.language.value]}))},changeStatus:function(data){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=new c.a(data),"active"!==data.status){t.next=7;break}return t.next=4,r.inactivate(e.$route.params.projectId,data.id);case 4:n=t.sent,t.next=10;break;case 7:return t.next=9,r.activate(e.$route.params.projectId,data.id);case 9:n=t.sent;case 10:n&&n.data.success?(o=n.data.blog.status,e.$Message.success({content:e.$t("messages.successfully_"+o),duration:3})):n.data&&n.data.error?e.$Message.error({content:n.data.error,duration:8}):e.$Message.error({content:e.$t("messages.fail"),duration:8}),e.$emit("reloadData");case 12:case"end":return t.stop()}}),t)})))()},handleBeforeChange:function(){var e=this;return new Promise((function(t){e.$Modal.confirm({title:e.$t("pages.confirm"),content:e.$t("messages.confirm_change_status"),okText:e.$t("button.ok"),cancelText:e.$t("button.cancel"),onOk:function(){t()}})}))},statusSetting:function(e){return"active"===e}}},l=n(9),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Table",{attrs:{columns:e.columns,data:e.items,loading:e.loading,"no-data-text":e.$t("pages.no_data")},scopedSlots:e._u([{key:"running_number",fn:function(t){var r=t.row;return[n("nuxt-link",{attrs:{to:{name:"projects-projectId-blogs-blogId-show",params:{projectId:e.$route.params.projectId,blogId:r.id}}}},[e._v("\n        "+e._s(r.running_number)+"\n      ")])]}},{key:"category",fn:function(t){var r=t.row;return e._l(e.getTagName(r.tag_name_translations),(function(t,r){return n("Tag",{key:r,staticClass:"text-center",attrs:{color:"default"}},[e._v("\n        "+e._s(t)+"\n      ")])}))}},{key:"owner",fn:function(t){var n=t.row;return[e._v("\n      "+e._s(n.owner["full_name_"+e.$store.state.language.value])+"\n    ")]}},{key:"status",fn:function(t){var r=t.row;return[n("i-switch",{attrs:{size:"small",value:e.statusSetting(r.status),"before-change":e.handleBeforeChange,"true-color":"#77bd98","false-color":"#F3F3F3"},on:{"on-change":function(t){return e.changeStatus(r)}}})]}}])})],1)}),[],!1,null,"60eec06c",null);t.default=component.exports}}]);